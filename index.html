<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GISFishIt ‚Äî Global Fishing Zones & Safety</title>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- MarkerCluster for performance -->
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster-src.js"></script>

<!-- Chart.js for weather visualization -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  /* ===== Theme C (professional) + glassmorphism + ocean slideshow background ===== */
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;600;700&display=swap');
  :root{
    --accent: #1572e8;
    --nav: #0b66b3;
    --bg-light: #e9f5ff;
    --card: rgba(255,255,255,0.78);
    --text: #052033;
    --muted: #526170;
    --glass-blur: 10px;
    --panel-width: 300px;
  }
  body{margin:0;font-family:Roboto,system-ui,-apple-system,"Segoe UI",Arial;smooth-font:antialiased;background:var(--bg-light);color:var(--text);min-height:100vh}
  body.dark{--card: rgba(7,12,20,0.68);background:#041026;color:#dbefff}

  /* slideshow full-screen background */
  .bg-slideshow{position:fixed;inset:0;z-index:-3;overflow:hidden}
  .bg-slide{position:absolute;inset:0;background-size:cover;background-position:center;opacity:0;transition:opacity 1.6s ease, transform 25s ease-in-out;transform:scale(1)}
  .bg-slide.active{opacity:1;transform:scale(1.03)}
  .bg-overlay{position:fixed;inset:0;backdrop-filter: blur(2px) saturate(1.05);z-index:-2;pointer-events:none}

  /* Intro screen - MODIFIED */
  #intro-screen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:1600;color:white;background:rgba(11,102,179,0.7);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);transition:opacity .6s ease}
  #intro-screen div{text-align:center;padding:32px;max-width:880px}
  #intro-screen h1{font-size:3.6rem;margin:0 0 12px 0;font-weight:800;letter-spacing:.06em}
  #intro-screen p{font-size:1.1rem;margin:0 0 22px 0;opacity:.95}
  #intro-screen button{font-size:1.05rem;padding:12px 26px;border-radius:999px}

  /* HEADER with LOGO */
  header{padding:10px 18px;background:linear-gradient(90deg,var(--nav),#2b9be8);color:white;box-shadow:0 8px 30px rgba(6,30,54,.12);position:relative;z-index:1200}
  header .wrap{max-width:1200px;margin:0 auto;display:flex;gap:16px;align-items:center}
  header .logo { height: 50px; width: auto; }
  header .title-group { flex-grow: 1; }
  header h1{margin:0;font-weight:700;font-size:1.4rem;letter-spacing:.01em}
  header .sub{opacity:.95;font-size:.9rem}

  nav.top{position:sticky;top:12px;z-index:1200;display:flex;justify-content:center;padding:.6rem}
  .nav-inner{max-width:1200px;width:100%;display:flex;gap:.5rem;align-items:center}
  .btn{background:var(--card);padding:.45rem .7rem;border-radius:10px;border:1px solid rgba(10,20,40,0.04);cursor:pointer;font-weight:600;color:var(--text);box-shadow:0 8px 20px rgba(6,30,54,0.06)}
  .btn.primary{background:linear-gradient(180deg,var(--accent),#1b63c7);color:#fff;border:none}
  .btn.small{padding:.35rem .55rem;font-size:.92rem}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.08)}
  .btn.toggle{padding:.35rem .5rem;font-weight:600}

  .container{max-width:1200px;margin:18px auto;padding:0 14px}
  .card{background:var(--card);border-radius:12px;padding:24px;box-shadow:0 10px 30px rgba(6,30,54,0.06);backdrop-filter: blur(var(--glass-blur));-webkit-backdrop-filter: blur(var(--glass-blur));margin-bottom:14px}
  .row{display:flex;gap:10px;align-items:center}
  .controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}

  /* map */
  #map-section-card { padding: 12px; }
  #map{height:720px;border-radius:12px;overflow:hidden;box-shadow:0 18px 60px rgba(6,30,54,0.08)}
  .panel-floating{position:absolute;left:12px;top:116px;z-index:1400;min-width:var(--panel-width)}
  .panel{background:var(--card);padding:10px;border-radius:10px;box-shadow:0 8px 30px rgba(6,30,54,0.08);backdrop-filter: blur(var(--glass-blur))}
  .small{font-size:.92rem;color:var(--muted)}
  
  /* ===== POSISI LEGENDA YANG DIPERBAIKI ===== */
  .legend {
  position: absolute;
  right: 18px;
  top: 140px; /* Diubah dari 260px ke 140px agar tidak bertumpuk dengan panel */
  z-index: 1300; /* Diubah dari 1400 ke 1300 agar di bawah panel forecast */
  max-width: 180px;
  }
  .legend .item{display:flex;gap:8px;align-items:center;margin:6px 0}
  .box{width:14px;height:14px;border-radius:3px;display:inline-block}
  .map-ui-element.hidden{display:none!important}

  /* ===== POSISI LEGENDA YANG DIPERBAIKI ===== */
.legend {
  position: absolute;
  right: 18px;
  top: 140px; /* Diubah dari 260px ke 140px agar tidak bertumpuk dengan panel */
  z-index: 1300; /* Diubah dari 1400 ke 1300 agar di bawah panel forecast */
  max-width: 180px;
}

.legend .panel {
  background: var(--card);
  padding: 10px;
  border-radius: 10px;
  box-shadow: 0 8px 30px rgba(6,30,54,0.08);
  backdrop-filter: blur(var(--glass-blur));
}

.legend .item {
  display: flex;
  gap: 8px;
  align-items: center;
  margin: 6px 0;
}

.box {
  width: 14px;
  height: 14px;
  border-radius: 3px;
  display: inline-block;
}

  /* ===== MARINE FORECAST PANEL ===== */
  .marine-forecast-panel {
    position: absolute;
    right: 18px;
    top: 320px; /* Posisi di bawah legenda */
    z-index: 1250; /* Di bawah legenda */
    max-width: 250px;
    background: var(--card);
    padding: 12px;
    border-radius: 10px;
    box-shadow: 0 8px 30px rgba(6,30,54,0.08);
    backdrop-filter: blur(var(--glass-blur));
  }

  .marine-forecast-panel h4 {
    margin: 0 0 8px 0;
    font-size: 1rem;
    color: var(--text);
  }

  .marine-forecast-content {
    font-size: 0.85rem;
    line-height: 1.4;
  }

  .marine-forecast-item {
    display: flex;
    justify-content: space-between;
    margin: 4px 0;
    padding: 2px 0;
    border-bottom: 1px solid rgba(0,0,0,0.05);
  }

  .marine-forecast-label {
    color: var(--muted);
  }

  .marine-forecast-value {
    font-weight: 600;
    color: var(--text);
  }

  .marine-safety-status {
    margin-top: 8px;
    padding: 6px;
    border-radius: 6px;
    text-align: center;
    font-weight: 600;
    font-size: 0.8rem;
  }

  .safety-safe {
    background: rgba(34, 197, 94, 0.15);
    color: #16a34a;
    border: 1px solid rgba(34, 197, 94, 0.3);
  }

  .safety-caution {
    background: rgba(234, 179, 8, 0.15);
    color: #ca8a04;
    border: 1px solid rgba(234, 179, 8, 0.3);
  }

  .safety-danger {
    background: rgba(239, 68, 68, 0.15);
    color: #dc2626;
    border: 1px solid rgba(239, 68, 68, 0.3);
  }

  /* search */
  .search{display:flex;gap:8px;background:rgba(255,255,255,0.9);padding:8px;border-radius:10px;align-items:center}
  .search input{border:none;padding:8px;border-radius:8px;min-width:220px}
  .search button{padding:8px 10px;border-radius:8px;border:none;background:var(--nav);color:#fff}

  /* info fish table */
  table{width:100%;border-collapse:collapse;margin-top:8px}
  th,td{padding:8px;border-bottom:1px solid rgba(15,60,100,0.06);text-align:left;font-size:.95rem}
  th{font-weight:700;background:rgba(255,255,255,0.4)}

  /* footer */
  footer{position:fixed;left:16px;right:16px;bottom:16px;background:var(--card);padding:14px;border-radius:12px;box-shadow:0 14px 50px rgba(6,30,54,0.08);display:flex;gap:12px;align-items:flex-start;z-index:1400;backdrop-filter: blur(var(--glass-blur));transition: transform 0.3s ease, opacity 0.3s ease;transform: translateY(0);opacity:1}
  footer.hidden{transform: translateY(120%);opacity:0;pointer-events:none}
  .footer-col{flex:1}
  .footer-title{font-weight:700;margin-bottom:6px}
  .footer-actions{display:flex;gap:8px;margin-top:8px}

  /* ===== Home section RESTRUCTURED ===== */
  .home-intro-row { display: flex; gap: 24px; align-items: flex-start; }
  .home-welcome-text { flex: 3; }
  .home-slider-container { flex: 2; max-width: 40%; position: relative; height: 320px; border-radius: 12px; overflow: hidden; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
  .slider { width: 100%; height: 100%; }
  .slide { display: none; width: 100%; height: 100%; transition: opacity 0.8s ease; }
  .slide.active { display: block; }
  .slide img { width: 100%; height: 100%; object-fit: cover; }
  .slider-btn { position: absolute; top: 50%; transform: translateY(-50%); background-color: rgba(0,0,0,0.45); color: white; border: none; padding: 0; cursor: pointer; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; display: flex; align-items: center; justify-content: center; z-index: 10; transition: background-color .2s ease; }
  .slider-btn:hover { background-color: rgba(0,0,0,0.6); }
  .prev { left: 12px; }
  .next { right: 12px; }
  .home-feature-explanation { margin-top: 2.5rem; padding-top: 1.5rem; border-top: 1px solid rgba(0,0,0,0.1); }
  
  /* Feature Tab Navigation */
  .feature-nav { display: flex; gap: 8px; border-bottom: 2px solid rgba(100,150,200,0.15); margin-bottom: 1rem; }
  .feature-nav-btn { border: none; background: transparent; padding: 10px 16px; font-size: 1rem; font-weight: 600; cursor: pointer; color: var(--muted); border-bottom: 3px solid transparent; transition: color 0.2s, border-color 0.2s; }
  .feature-nav-btn.active { color: var(--accent); border-bottom-color: var(--accent); }
  .feature-content { display: none; line-height: 1.6; }
  .feature-content.active { display: block; }

  /* ===== Warning Banner ===== */
  .warning-banner { background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; border-radius: 8px; padding: 12px 16px; margin-bottom: 20px; font-size: 0.95rem; display: flex; align-items: center; gap: 10px; }
  .warning-icon { font-size: 1.5rem; line-height: 1; }
  
  /* ===== ABOUT US SECTION (UPDATED) ===== */
  #aboutSection h2, #aboutSection h3 { text-align: center; color: var(--text); }
  #aboutSection .about-subsection { margin-bottom: 3rem; }
  
  /* FIXED: Only justify direct child paragraphs of about-subsection */
  #aboutSection .about-subsection > p {
      max-width: 800px;
      margin: 1rem auto;
      line-height: 1.7;
      text-align: justify;
  }
  #aboutSection h3 { font-size: 1.6rem; margin-bottom: 1.5rem; }
  
  .team-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 24px;
    margin-top: 20px;
  }
  .profile-card {
    padding-top: 20px;
    background: rgba(255,255,255,0.6);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    text-align: center;
  }
  .profile-card:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(0,0,0,0.12); }
  
  .profile-card img {
    width: 150px;
    height: 150px;
    object-fit: cover;
    border-radius: 50%;
    margin-bottom: 15px;
    border: 4px solid white;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  }

  .profile-details { padding: 0 20px 20px 20px; text-align: center; display: flex; flex-direction: column; }
  .profile-details h4 { margin: 0 0 8px 0; font-size: 1.3rem; color: var(--accent); }
  .profile-details .role { font-weight: 700; display: block; margin-bottom: 12px; color: var(--text); font-size: 1rem; }
  .profile-details .interest {
      margin: 8px 0;
      font-size: 0.95rem;
      line-height: 1.5;
      color: var(--muted);
      flex-grow: 1;
      text-align: left; /* Ensures text is left-aligned */
  }
  .social-links { display: flex; justify-content: center; gap: 16px; margin-top: 16px; border-top: 1px solid rgba(0,0,0,0.05); padding-top: 16px; }
  .social-links a { display: inline-block; transition: transform 0.2s ease; }
  .social-links a:hover { transform: scale(1.15); }
  .social-links svg { width: 24px; height: 24px; fill: var(--muted); transition: fill 0.2s ease; }
  .social-links a:hover svg { fill: var(--accent); }
  body.dark .profile-card { background: rgba(0,0,0,0.2); }
  body.dark .profile-card img { border-color: #2c3e50; }
  body.dark .social-links { border-top-color: rgba(255,255,255,0.1); }
  body.dark .social-links svg { fill: #9ab; }
  body.dark .social-links a:hover svg { fill: var(--accent); }

  /* ===== WEATHER SECTION STYLES ===== */
  .weather-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }
  
  .weather-current {
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  
  .weather-location {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
  }
  
  .weather-location h3 {
    margin: 0;
    font-size: 1.5rem;
  }
  
  .weather-location input {
    background: rgba(255,255,255,0.2);
    border: 1px solid rgba(255,255,255,0.3);
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    margin-left: 10px;
    flex-grow: 1;
  }
  
  .weather-location input::placeholder {
    color: rgba(255,255,255,0.7);
  }
  
  .weather-main {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 15px;
  }
  
  .weather-icon {
    font-size: 4rem;
  }
  
  .weather-temp {
    font-size: 3rem;
    font-weight: 700;
  }
  
  .weather-desc {
    font-size: 1.2rem;
    margin-bottom: 15px;
    text-transform: capitalize;
  }
  
  .weather-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
  }
  
  .weather-detail {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .weather-forecast {
    background: var(--card);
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  
  .weather-forecast h3 {
    margin-top: 0;
    color: var(--text);
  }
  
  .forecast-days {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 10px;
    margin-top: 15px;
  }
  
  .forecast-day {
    text-align: center;
    background: rgba(0,0,0,0.05);
    border-radius: 8px;
    padding: 10px;
  }
  
  .forecast-day-name {
    font-weight: 600;
    margin-bottom: 5px;
  }
  
  .forecast-day-icon {
    font-size: 1.5rem;
    margin-bottom: 5px;
  }
  
  .forecast-day-temp {
    font-size: 0.9rem;
  }
  
  .weather-marine {
    grid-column: span 2;
    background: var(--card);
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  
  .weather-marine h3 {
    margin-top: 0;
    color: var(--text);
  }
  
  .marine-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-top: 15px;
  }
  
  .marine-detail {
    background: rgba(0,0,0,0.05);
    border-radius: 8px;
    padding: 15px;
    text-align: center;
  }
  
  .marine-detail-icon {
    font-size: 2rem;
    margin-bottom: 10px;
  }
  
  .marine-detail-value {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 5px;
  }
  
  .marine-detail-label {
    font-size: 0.9rem;
    color: var(--muted);
  }
  
  .weather-chart-container {
    grid-column: span 2;
    background: var(--card);
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    height: 300px;
  }
  
  .weather-alert {
    background-color: #ff9800;
    color: white;
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .weather-alert.danger {
    background-color: #f44336;
  }
  
  .weather-alert-icon {
    font-size: 1.5rem;
  }
  
  .weather-alert-text {
    flex-grow: 1;
  }
  
  .weather-alert-title {
    font-weight: 700;
    margin-bottom: 5px;
  }

  /* ===== Fish Movement Controls ===== */
  .fish-controls {
    background: var(--card);
    padding: 15px;
    border-radius: 10px;
    margin-top: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  
  .fish-controls h4 {
    margin-top: 0;
    margin-bottom: 10px;
    color: var(--text);
  }
  
  .fish-controls .controls-row {
    display: flex;
    gap: 10px;
    align-items: center;
    flex-wrap: wrap;
    margin-bottom: 10px;
  }
  
  .fish-controls .speed-slider {
    flex-grow: 1;
  }
  
  .fish-controls .speed-value {
    min-width: 40px;
    text-align: center;
    font-weight: bold;
  }

  /* Animation for moving fish */
  @keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
    100% { transform: scale(1); opacity: 1; }
  }

  .moving-fish-marker {
    animation: pulse 2s infinite;
  }

  /* responsive */
  @media (max-width:980px){
    .row{flex-direction:column;align-items:stretch}
    .panel-floating{left:8px;right:8px;top:140px;min-width:unset}
    
    /* ===== RESPONSIVE POSISI LEGENDA ===== */
    .legend {
      right: 8px;
      top: 140px;
      max-width: calc(100% - 16px);
    }

    /* ===== RESPONSIVE MARINE FORECAST PANEL ===== */
    .marine-forecast-panel {
      right: 8px;
      top: 320px;
      max-width: calc(100% - 16px);
    }
    
    .right-panel{right:8px;top:140px;width:calc(100% - 16px)}
    footer{left:8px;right:8px;bottom:8px;flex-direction:column}
    #map{height:520px}
    .home-intro-row { flex-direction: column; }
    .home-slider-container { max-width: 100%; width: 100%; }
    .feature-nav { flex-wrap: wrap; }
    .weather-container {
      grid-template-columns: 1fr;
    }
    .weather-marine, .weather-chart-container {
      grid-column: span 1;
    }
    .fish-controls .controls-row {
      flex-direction: column;
      align-items: stretch;
    }
  }
</style>
</head>
<body>
  <!-- background slideshow (transparent glass effect shows it) -->
  <div class="bg-slideshow" aria-hidden="true">
    <div class="bg-slide active" style="background-image:url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1920&q=60');"></div>
    <div class="bg-slide" style="background-image:url('https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=1920&q=60');"></div>
    <div class="bg-slide" style="background-image:url('https://images.unsplash.com/photo-1465101178521-c1a9136a07b1?auto=format&fit=crop&w=1920&q=60');"></div>
    <div class="bg-slide" style="background-image:url('https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=1920&q=60');"></div>
  </div>
  <div class="bg-overlay"></div>

  <!-- Intro splash screen -->
  <div id="intro-screen">
    <div>
      <h1>GISFishIt</h1>
      <p>Global fishing zones & simulated marine forecasts ‚Äî safety-first for fishers.</p>
      <button id="start-btn" class="btn primary">Get Started</button>
    </div>
  </div>

  <header>
    <div class="wrap">
      <!-- PASTE LOGO CODE HERE -->
      <img src="https://iili.io/f92qyfs.png" class="logo">
      <div class="title-group">
        <h1>GISFishIt</h1>
        <div class="sub" data-i18n="header_subtitle">Web Helper to assist fishermen in catching fish and preserving the sea</div>
      </div>
    </div>
  </header>

  <nav class="top">
    <div class="nav-inner">
      <button class="btn nav-btn active" data-target="home" data-i18n="nav_home">Home</button>
      <button class="btn nav-btn" data-target="mapSection" data-i18n="nav_map">Map</button>
      <button class="btn nav-btn" data-target="weatherSection" data-i18n="nav_weather">Weather</button>
      <button class="btn nav-btn" data-target="infoSection" data-i18n="nav_info">Fish Info</button>
      <button class="btn nav-btn" data-target="aboutSection" data-i18n="nav_about">About</button>

      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <select id="lang-select" class="btn small" aria-label="Language">
          <option value="en">English</option>
          <option value="id">Indonesia</option>
          <option value="fr">Fran√ßais</option>
          <option value="jp">Êó•Êú¨Ë™û</option>
          <option value="es">Espa√±ol</option>
          <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
        </select>
        <button id="toggle-theme" class="btn small" data-i18n="nav_theme">üåì Theme</button>
        <button id="toggle-random" class="btn small">‚è± Random ON</button>
      </div>
    </div>
  </nav>

  <main class="container">
    <!-- HOME SECTION RESTRUCTURED -->
    <section id="home" class="card">
      
      <div class="home-intro-row">
        <!-- Left Column: Welcome Text -->
        <div class="home-welcome-text">
          <div class="warning-banner">
            <span class="warning-icon">&#9888;</span>
            <div><strong>PERHATIAN:</strong> TOLONG DIBACA DENGAN LENGKAP AGAR DAPAT MEMBANTU DAN MENJAGA KESELAMATAN ANDA DALAM MENANGKAP IKAN.</div>
          </div>
          <h2>Selamat Datang di GISFishIt</h2>
          <p>Halo para nelayan yang hebat, kami dari mahasiswa UPI kampus daerah Serang asal Indonesia membuat website ini bertujuan untuk menciptakan zona penangkapan ikan yang legal serta aman bagi kelestarian kehidupan yang ada di perairan seluruh dunia. Kami berharap dengan adanya website ini dapat membantu nelayan di seluruh dunia mengurangi overfishing dan membantu nelayan juga dalam mencari ikan yang aman untuk ditangkap, maksudnya nelayan hanya diperbolehkan menangkap ikan yang jumlah koloninya masih tergolong banyak dan mencegah ikan yang ada di tempat tersebut punah.</p>
        </div>

        <!-- Right Column: Slideshow -->
        <div class="home-slider-container">
          <div class="slider">
            <div class="slide active"><img src="https://images.pexels.com/photos/2131967/pexels-photo-2131967.jpeg" alt="Nelayan sedang menebar jala di perahu"></div>
            <div class="slide"><img src="https://aruna.id/wp-content/uploads/2023/06/nelayan-indonesia-perahu-nelayan.webp" alt="Siluet nelayan menjaring ikan saat matahari terbenam"></div>
            <div class="slide"><img src="https://cdn01.metrotvnews.com/dynamic/content/2024/07/05/NxGCzgBV/a_6687c45c20c55.jpg?w=720" alt="Nelayan Indonesia di perahu"></div>
          </div>
          <button class="slider-btn prev" onclick="moveSlide(-1)">&#10094;</button>
          <button class="slider-btn next" onclick="moveSlide(1)">&#10095;</button>
        </div>
      </div>

      <!-- Feature Explanation Section with Tabs -->
      <div class="home-feature-explanation">
        <h2 style="font-size: 1.5rem;">Yuk!! kenalan dulu ama beberapa fitur yang ada di website ini</h2>
        
        <!-- Tab Navigation -->
        <div class="feature-nav">
          <button class="feature-nav-btn active" data-target="feature-home-content">HOME</button>
          <button class="feature-nav-btn" data-target="feature-map-content">Peta Zona Tangkap</button>
          <button class="feature-nav-btn" data-target="feature-weather-content">Perkiraan Cuaca</button>
          <button class="feature-nav-btn" data-target="feature-fish-content">Info Ikan</button>
        </div>

        <!-- Tab Content -->
        <div class="feature-content-wrapper">
          <div id="feature-home-content" class="feature-content active">
            <h3>HOME (Beranda)</h3>
            <p>Bagian Home adalah pintu masuk utama ke website GISFishIt. Di sini, siapa pun‚Äîbaik nelayan pemula, pelajar, hingga masyarakat umum‚Äîakan mendapatkan sambutan hangat beserta penjelasan singkat tentang tujuan utama website ini. Website GISFishIt hadir untuk membantu Anda mengenal lebih dalam tentang zona penangkapan ikan yang aman dan legal, serta pentingnya menjaga kelestarian laut kita. Pada halaman ini Anda akan disajikan informasi dan pengumuman terbaru, entah itu tentang aturan baru terkait penangkapan ikan, perkiraan cuaca laut, maupun update fitur penting pada website. Semua informasi di Home ditulis dengan bahasa yang mudah dipahami, sehingga Anda yang baru pertama kali menggunakan website ini tetap bisa mengikuti dengan nyaman. Tidak perlu khawatir jika Anda belum familiar dengan istilah kelautan atau teknologi digital, karena setiap fitur diperkenalkan secara sederhana dan step-by-step. Selain itu, Home juga menampilkan pengantar tentang navigasi menu utama, seperti Peta Zona Tangkap, Perkiraan Cuaca, dan Info Ikan. Anda akan dipandu untuk memilih bagian atau fitur yang paling relevan dan bermanfaat dengan kebutuhan Anda. Intinya, Home memberikan orientasi agar Anda tidak bingung saat pertama kali mengunjungi GISFishIt, serta memastikan semua pengguna dapat menggunakan layanan ini secara optimal dan aman. Jika Anda masih merasa kesulitan, Anda dapat membaca panduan, tips, bahkan menghubungi tim kami melalui kontak yang tersedia pada website. GISFishIt ingin membantu Anda tidak hanya menjadi nelayan yang produktif, tetapi juga nelayan yang sadar akan pentingnya pelestarian laut untuk masa depan bersama.</p>
          </div>
          <div id="feature-map-content" class="feature-content">
            <h3>Peta Zona Tangkap</h3>
            <p>Fitur ini adalah jantung utama dari website GISFishIt dan sangat penting untuk membantu nelayan serta masyarakat umum memahami di mana saja aktivitas penangkapan ikan boleh dilakukan secara aman dan legal. Pada halaman ini, Anda akan melihat peta digital yang menandai zona-zona penangkapan ikan di perairan Indonesia. Peta ini dirancang dan diperbarui secara berkala, mengambil referensi dari prinsip-prinsip keberlanjutan dan hasil pengamatan lapangan maupun citra satelit. Dengan adanya visualisasi langsung, nelayan dapat mengetahui lokasi mana yang direkomendasikan untuk menangkap ikan dan lokasi mana yang perlu dihindari demi menjaga keseimbangan ekosistem laut. Salah satu elemen utama adalah <strong>filter zona</strong> berdasarkan warna:</p>
            <ul style="padding-left: 20px; margin-top: 0.5rem; list-style-type: square;">
              <li><strong style="color: green;">Hijau:</strong> Menandakan zona aman untuk menangkap ikan. Populasi ikan di area ini stabil dan cukup banyak. Penangkapan di zona hijau dianjurkan untuk memenuhi kebutuhan konsumsi maupun ekonomi nelayan.</li>
              <li><strong style="color: goldenrod;">Kuning:</strong> Zona hati-hati. Area ini sedang mengalami masa perkembangbiakan atau pemulihan populasi. Bila memungkinkan, sebaiknya aktivitas penangkapan dihindari agar siklus hidup ikan berjalan lancar dan stok ikan tidak terganggu.</li>
              <li><strong style="color: red;">Merah:</strong> Zona terlarang. Populasi ikan sangat sedikit, habitat kritis, atau sedang mengalami tekanan tinggi akibat aktivitas manusia. Aktivitas penangkapan di zona merah dilarang keras untuk mencegah kepunahan lokal dan kerusakan ekosistem.</li>
            </ul>
            <p>Selain menampilkan posisi zona, peta ini juga terintegrasi dengan <strong>Marine Forecast & Safety</strong>‚Äîsebuah fitur perkiraan cuaca laut berbasis data teknologi dan simulasi. Anda cukup klik zona atau titik tertentu, lalu sistem akan menampilkan estimasi tinggi gelombang, kecepatan angin, suhu permukaan laut, dan status rekomendasi keselamatan melaut (aman, hati-hati, berbahaya). Ini dapat membantu Anda menentukan waktu dan lokasi paling tepat untuk melaut, sehingga meminimalisir risiko kecelakaan dan kerugian. Jangan lupa pula dengan <strong>fitur legenda</strong> yang terdapat di pojok peta. Legenda ini adalah panduan cepat mengenai makna warna zona pada peta, sehingga seluruh informasi tetap mudah dimengerti dan Anda tidak perlu menghafal kodenya. Fitur ini diciptakan demi menunjang hasil tangkapan yang maksimal, efisiensi bahan bakar, serta mendukung upaya nasional dalam menjaga keberlanjutan sumber daya ikan di Indonesia. Dengan memahami dan memanfaatkan zona tangkap, nelayan dapat mengurangi praktik overfishing, meningkatkan pendapatan secara berkelanjutan, dan membantu menjaga laut agar terus lestari hingga generasi mendatang.</p>
          </div>
          <div id="feature-weather-content" class="feature-content">
            <h3>Perkiraan Cuaca</h3>
            <p>Fitur Perkiraan Cuaca adalah alat bantu penting untuk keselamatan dan efektivitas aktivitas melaut. Cuaca laut yang tidak terduga dapat membahayakan nyawa nelayan dan merusak peralatan penangkapan ikan. Di GISFishIt, kami menyediakan informasi cuaca yang akurat dan mudah dipahami, termasuk perkiraan gelombang, kecepatan angin, suhu permukaan laut, dan kondisi cuaca umum. Data ini diperbarui secara berkala dan disajikan dalam bentuk visual yang intuitif, sehingga Anda dapat membuat keputusan yang tepat sebelum pergi melaut. Fitur ini juga dilengkapi dengan peringatan dini jika ada kondisi cuaca ekstrem yang berpotensi berbahaya, seperti badai, angin kencang, atau gelombang tinggi. Dengan memanfaatkan informasi cuaca yang kami sediakan, Anda dapat merencanakan perjalanan melaut dengan lebih aman, menghindari risiko yang tidak perlu, dan meningkatkan efisiensi waktu dan bahan bakar. perkiraan cuaca kami mencakup informasi untuk beberapa hari ke depan, sehingga Anda dapat merencanakan aktivitas penangkapan ikan dengan lebih baik. Selain itu, kami juga menyediakan tips dan rekomendasi berdasarkan kondisi cuaca yang diprediksi, seperti jenis ikan yang mungkin lebih aktif dalam kondisi cuaca tertentu atau area penangkapan yang lebih aman berdasarkan perkiraan gelombang. GISFishIt berkomitmen untuk membantu nelayan tidak hanya meningkatkan hasil tangkapan, tetapi juga memastikan keselamatan Anda di laut.</p>
          </div>
          <div id="feature-fish-content" class="feature-content">
            <h3>Info Ikan</h3>
            <p>Bagian ini adalah ensiklopedia mini Anda. Berisi daftar ikan air asin dan air tawar yang umum ditemukan di perairan Indonesia. Setiap entri menyediakan informasi lengkap mulai dari <strong>Nama</strong>, <strong>Deskripsi</strong>, perkiraan <strong>Harga</strong> di pasaran, <strong>Lokasi Umum</strong>, <strong>Habitat</strong>, hingga <strong>Musim Terbaik</strong> untuk menangkapnya.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- MAP SECTION -->
    <section id="mapSection" class="card" id="map-section-card" style="display:none;">
      <div class="row" style="justify-content:space-between;align-items:center;margin-bottom:10px">
        <div class="search" role="search">
          <input id="loc-input" data-i18n-placeholder="search_placeholder" placeholder="Search location (e.g. Pacific Ocean or '12.34, 56.78')" />
          <button id="btn-search" data-i18n="btn_search">Search</button>
          <button id="btn-home" title="Home" data-i18n-title="btn_home">Home</button>
        </div>
        <div class="controls">
          <button id="btn-gen" class="btn" data-i18n="generate">Generate Zones</button>
          <button id="btn-load" class="btn" data-i18n="load_geo">Load GeoJSON</button>
          <button id="btn-export-fav" class="btn" data-i18n="export_fav">Export Favorites</button>
          <button id="btn-clear-reports" class="btn" data-i18n="clear_reports">Clear Reports</button>
          <button id="btn-toggle-all" class="btn" data-i18n="btn_all_feature">ALL FEATURE</button>
        </div>
      </div>

      <div id="map-wrapper" style="position:relative">
        <div id="map" aria-label="Map (world)"></div>

        <!-- left floating controls -->
        <div class="panel-floating map-ui-element">
          <div class="panel">
            <h4 data-i18n="map_zone_filters">Zone Filters</h4>
            <label><input type="checkbox" id="show-green" checked/> <span data-i18n="map_green_safe">Green ‚Äî Safe</span></label><br/>
            <label><input type="checkbox" id="show-yellow" checked/> <span data-i18n="map_yellow_caution">Yellow ‚Äî Caution</span></label><br/>
            <label><input type="checkbox" id="show-red" checked/> <span data-i18n="map_red_restricted">Red ‚Äî Restricted</span></label>

            <hr style="margin:10px 0"/>
            <div style="display:flex;gap:8px">
              <button id="btn-random-toggle" class="btn small" data-i18n="toggle_random">Toggle Random</button>
              <button id="btn-regen" class="btn small" data-i18n="regen">Regenerate</button>
            </div>

            <!-- Fish Movement Controls -->
            <div class="fish-controls">
              <h4>Fish Movement Controls</h4>
              <div class="controls-row">
                <button id="btn-toggle-fish-movement" class="btn small">Start Fish Movement</button>
                <span id="fish-movement-status" class="small">Stopped</span>
              </div>
              <div class="controls-row">
                <label class="small">Speed:</label>
                <input type="range" id="fish-speed-slider" class="speed-slider" min="1" max="10" value="3">
                <span id="fish-speed-value" class="speed-value">3x</span>
              </div>
              <div class="controls-row">
                <button id="btn-reset-fish-positions" class="btn small">Reset Positions</button>
              </div>
            </div>

            <div style="margin-top:12px">
              <h4 data-i18n="map_quick_tips">Quick Tips</h4>
              <div class="small" data-i18n="map_tip_report">Press <strong>R</strong> to enter report mode...</div>
              <div style="margin-top:8px" class="small" data-i18n="map_tip_forecast">Click any zone to view...</div>
            </div>
          </div>
        </div>

        <!-- right collapsible panel -->
        <div id="rightPanel" class="right-panel closable map-ui-element">
          <div class="panel">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <h4 data-i18n="map_forecast_title">Marine Forecast & Safety</h4>
              <div><button id="toggle-panel" class="btn small" data-i18n="map_panel_close">Close</button></div>
            </div>

            <div id="forecast-content" style="margin-top:10px">
              <div id="forecast-info" class="small" data-i18n="safety_click">Click a zone or map point to simulate...</div>
              <hr/>
              <div id="forecast-details" class="small" style="line-height:1.4"></div>
              <div style="margin-top:10px">
                <button id="btn-refresh-forecast" class="btn small" data-i18n="map_refresh_forecast">Refresh Forecast</button>
                <label style="margin-left:8px" class="small"><input type="checkbox" id="auto-update-forecast" checked/> <span data-i18n="map_auto_update">Enable real-time updates</span></label>
              </div>
            </div>
          </div>
        </div>

        <!-- LEGENDA (DIPERBAIKI) -->
        <div class="legend map-ui-element">
          <div class="panel">
            <strong data-i18n="map_legend">Legend</strong>
            <div class="item"><span class="box" style="background:green"></span> <span data-i18n="map_green_safe">Green ‚Äî Safe</span></div>
            <div class="item"><span class="box" style="background:goldenrod;border:1px solid #c59b00;"></span> <span data-i18n="map_yellow_caution">Yellow ‚Äî Caution</span></div>
            <div class="item"><span class="box" style="background:red"></span> <span data-i18n="map_red_restricted">Red ‚Äî Restricted</span></div>
            <!-- Baris Moving Fish Zones dihapus -->
          </div>
        </div>

        <!-- MARINE FORECAST PANEL (BARU) -->
        <div class="marine-forecast-panel map-ui-element">
          <h4>Marine Forecast & Safety</h4>
          <div class="marine-forecast-content">
            <div class="marine-forecast-item">
              <span class="marine-forecast-label">Wave Height:</span>
              <span class="marine-forecast-value" id="marine-forecast-wave">1.2 m</span>
            </div>
            <div class="marine-forecast-item">
              <span class="marine-forecast-label">Wind Speed:</span>
              <span class="marine-forecast-value" id="marine-forecast-wind">8.5 m/s</span>
            </div>
            <div class="marine-forecast-item">
              <span class="marine-forecast-label">Water Temp:</span>
              <span class="marine-forecast-value" id="marine-forecast-temp">28.5¬∞C</span>
            </div>
            <div class="marine-forecast-item">
              <span class="marine-forecast-label">Visibility:</span>
              <span class="marine-forecast-value" id="marine-forecast-visibility">Good</span>
            </div>
            <div class="marine-safety-status safety-safe" id="marine-safety-status">
              Safe Conditions
            </div>
            <div style="margin-top: 8px; font-size: 0.75rem; color: var(--muted); text-align: center;">
              Click on map for detailed forecast
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- WEATHER SECTION -->
    <section id="weatherSection" class="card" style="display:none;">
      <h2 data-i18n="weather_title">Marine Weather Forecast</h2>
      
      <div class="weather-container">
        <div class="weather-current">
          <div class="weather-location">
            <h3 id="weather-location-name">Jakarta, Indonesia</h3>
            <input type="text" id="weather-location-input" placeholder="Search location..." />
          </div>
          
          <div class="weather-main">
            <div class="weather-icon" id="weather-current-icon">‚òÄÔ∏è</div>
            <div class="weather-temp" id="weather-current-temp">28¬∞C</div>
          </div>
          
          <div class="weather-desc" id="weather-current-desc">Clear Sky</div>
          
          <div class="weather-details">
            <div class="weather-detail">
              <span>üíß</span>
              <span>Humidity: <span id="weather-humidity">75%</span></span>
            </div>
            <div class="weather-detail">
              <span>üí®</span>
              <span>Wind: <span id="weather-wind">12 km/h</span></span>
            </div>
            <div class="weather-detail">
              <span>üåä</span>
              <span>Wave: <span id="weather-wave">1.2 m</span></span>
            </div>
            <div class="weather-detail">
              <span>üëÅÔ∏è</span>
              <span>Visibility: <span id="weather-visibility">10 km</span></span>
            </div>
          </div>
        </div>
        
        <div class="weather-forecast">
          <h3 data-i18n="weather_forecast_title">5-Day Forecast</h3>
          
          <div class="forecast-days" id="forecast-days">
            <!-- Forecast days will be populated by JavaScript -->
          </div>
        </div>
      </div>
      
      <div class="weather-marine">
        <h3 data-i18n="weather_marine_title">Marine Conditions</h3>
        
        <div class="marine-details">
          <div class="marine-detail">
            <div class="marine-detail-icon">üåä</div>
            <div class="marine-detail-value" id="marine-wave-height">1.5 m</div>
            <div class="marine-detail-label">Wave Height</div>
          </div>
          
          <div class="marine-detail">
            <div class="marine-detail-icon">üå°Ô∏è</div>
            <div class="marine-detail-value" id="marine-water-temp">28¬∞C</div>
            <div class="marine-detail-label">Water Temperature</div>
          </div>
          
          <div class="marine-detail">
            <div class="marine-detail-icon">üí®</div>
            <div class="marine-detail-value" id="marine-wind-speed">15 km/h</div>
            <div class="marine-detail-label">Wind Speed</div>
          </div>
          
          <div class="marine-detail">
            <div class="marine-detail-icon">üß≠</div>
            <div class="marine-detail-value" id="marine-wind-dir">NE</div>
            <div class="marine-detail-label">Wind Direction</div>
          </div>
          
          <div class="marine-detail">
            <div class="marine-detail-icon">üåÖ</div>
            <div class="marine-detail-value" id="marine-tide">High</div>
            <div class="marine-detail-label">Tide</div>
          </div>
          
          <div class="marine-detail">
            <div class="marine-detail-icon">üåô</div>
            <div class="marine-detail-value" id="marine-moon">Waxing</div>
            <div class="marine-detail-label">Moon Phase</div>
          </div>
        </div>
      </div>
      
      <div class="weather-chart-container">
        <canvas id="weather-chart"></canvas>
      </div>
      
      <div id="weather-alert-container">
        <!-- Weather alerts will be populated by JavaScript -->
      </div>
    </section>

    <!-- INFO FISH SECTION -->
    <section id="infoSection" class="card" style="display:none;">
      <h3 data-i18n="info_title">Fish Info</h3>

      <h4 data-i18n="info_saltwater_title" style="margin-top: 1.5rem;">Saltwater Fish</h4>
      <table id="fish-table-saltwater" aria-live="polite">
        <thead>
          <tr>
            <th data-i18n="info_th_name">Name</th><th data-i18n="info_th_desc">Description</th><th data-i18n="info_th_price">Price</th><th data-i18n="info_th_locations">Common Locations</th><th data-i18n="info_th_habitat">Habitat</th><th data-i18n="info_th_season">Best Season</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <h4 data-i18n="info_freshwater_title" style="margin-top: 2rem;">Freshwater Fish</h4>
      <table id="fish-table-freshwater" aria-live="polite">
        <thead>
          <tr>
            <th data-i18n="info_th_name">Name</th><th data-i18n="info_th_desc">Description</th><th data-i18n="info_th_price">Price</th><th data-i18n="info_th_locations">Common Locations</th><th data-i18n="info_th_habitat">Habitat</th><th data-i18n="info_th_season">Best Season</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- ABOUT SECTION (UPDATED) -->
    <section id="aboutSection" class="card" style="display:none;">
      <div class="about-subsection">
        <h2>Cerita Kami</h2>
        <p>Proyek GISFishIt lahir dari keprihatinan kami sebagai mahasiswa Sistem Informasi Kelautan di UPI Kampus Serang. Kami melihat adanya dua tantangan besar: para nelayan tradisional sering kesulitan menentukan lokasi penangkapan yang optimal dan aman, sementara di sisi lain, ekosistem laut Indonesia menghadapi ancaman serius dari praktik penangkapan ikan berlebihan (overfishing). Berangkat dari diskusi di lingkungan kampus dan semangat untuk menerapkan ilmu yang kami pelajari, kami memutuskan untuk membangun solusi nyata. GISFishIt adalah jembatan antara teknologi informasi geospasial (GIS) dan kebutuhan para pahlawan bahari kita. Kami percaya bahwa dengan data yang tepat, teknologi dapat memberdayakan nelayan untuk meningkatkan hasil tangkapan mereka secara bertanggung jawab, sekaligus menjadi garda terdepan dalam menjaga kelestarian laut.</p>
      </div>

      <div class="about-subsection">
        <h3>Teknologi di Balik GISFishIt</h3>
        <p>Untuk mewujudkan visi kami, GISFishIt dibangun di atas beberapa pilar teknologi utama. Inti dari platform kami adalah <strong>Sistem Informasi Geografis (GIS)</strong>, yang memungkinkan kami memetakan dan menganalisis data spasial laut. Kami mensimulasikan zona penangkapan (hijau, kuning, merah) dan data cuaca maritim menggunakan algoritma yang mempertimbangkan berbagai faktor ekologis dan keamanan. Seluruh platform ini disajikan dalam bentuk <strong>aplikasi web yang responsif</strong>, dibangun dengan HTML, CSS, dan JavaScript modern, sehingga dapat diakses dengan mudah baik dari komputer maupun perangkat mobile di tengah laut.</p>
      </div>

      <div class="about-subsection">
        <h3>Komitmen Kami</h3>
        <p>Kami berkomitmen pada tiga nilai utama: <strong>Pemberdayaan Nelayan</strong>, dengan menyediakan alat bantu digital yang mudah digunakan untuk meningkatkan keselamatan dan efisiensi. <strong>Keberlanjutan Ekosistem</strong>, dengan mempromosikan praktik penangkapan yang bijaksana untuk mencegah overfishing dan melindungi keanekaragaman hayati laut. <strong>Edukasi dan Kolaborasi</strong>, dengan menjadi sumber informasi yang valid dan membuka peluang kerja sama dengan komunitas lokal, akademisi, dan pemerintah untuk menciptakan dampak yang lebih luas.</p>
      </div>
      
      <div class="about-subsection">
        <h3>Masa Depan GISFishIt</h3>
        <p>GISFishIt adalah proyek yang akan terus berkembang. Ke depannya, kami berencana untuk menambahkan fitur-fitur baru seperti pelacakan kapal secara real-time, integrasi data pasang surut, serta forum komunitas bagi para nelayan untuk berbagi informasi dan pengalaman. Tujuan jangka panjang kami adalah menjadikan GISFishIt sebagai platform rujukan utama bagi perikanan berkelanjutan di Indonesia.</p>
      </div>

      <div class="about-subsection">
        <h2 style="margin-top: 2rem;">Tim Kami</h2>
        <div class="team-container">
            <!-- Profile 1 -->
            <div class="profile-card">
                <!-- GANTI BARIS DI BAWAH INI DENGAN KODE IMG YANG ANDA SALIN -->
                <img src="https://iili.io/f929Hua.jpg">
                <div class="profile-details">
                    <h4>Ardian Rifqi</h4>
                    <span class="role">Lead Developer, Backend & GIS</span>
                    <p class="interest">üéì Berminat di bidang Pemograman serta Pengembangan untuk menciptakan solusi teknologi kelautan.</p>
                    <div class="social-links">
                        <a href="#" target="_blank" title="Instagram"><svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.264.057 2.15.247 2.91.556.786.31 1.457.718 2.123 1.385.667.666 1.076 1.337 1.385 2.123.31.76.5 1.646.558 2.91.058 1.267.07 1.647.07 4.85s-.012 3.584-.07 4.85c-.058 1.264-.248 2.15-.558 2.91-.31.786-.718 1.457-1.385 2.123-.666.667-1.337 1.076-2.123 1.385-.76.31-1.646.5-2.91.558-1.267.058-1.647.07-4.85.07s-3.584-.012-4.85-.07c-1.264-.057-2.15-.247-2.91-.558-.786-.31-1.457-.718-2.123-1.385-.667-.666-1.076-1.337-1.385-2.123-.31-.76-.5-1.646-.558-2.91-.058-1.267-.07-1.647-.07-4.85s.012-3.584.07-4.85c.058-1.264.248-2.15.558-2.91.31-.786.718-1.457 1.385-2.123.666-.667 1.337-1.076 2.123-1.385.76-.31 1.646-.5 2.91-.558C8.416 2.175 8.796 2.163 12 2.163zm0 1.802c-3.144 0-3.486.01-4.698.067-1.19.055-1.89.232-2.428.45- .56.227-.96.517-1.38.938-.42.42-.71.82-.938 1.38-.218.538-.4 1.237-.45 2.428C2.175 8.514 2.163 8.856 2.163 12s.01 3.486.067 4.698c.055 1.19.232 1.89.45 2.428.227.56.517.96.938 1.38.42.42.82.71 1.38.938.538.218 1.237.4 2.428.45 1.212.057 1.554.067 4.698.067s3.486-.01 4.698-.067c1.19-.055 1.89-.232 2.428-.45.56-.227.96-.517 1.38-.938.42-.42.71-.82.938-1.38.218-.538.4-1.237-.45-2.428.057-1.212.067-1.554.067-4.698s-.01-3.486-.067-4.698c-.055-1.19-.232-1.89-.45-2.428-.227-.56-.517-.96-.938-1.38-.42-.42-.82-.71-1.38-.938-.538-.218-1.237-.4-2.428-.45-1.212-.057-1.554-.067-4.698-.067zm0 3.67c-3.405 0-6.162 2.757-6.162 6.162s2.757 6.162 6.162 6.162 6.162-2.757 6.162-6.162-2.757-6.162-6.162-6.162zm0 10.16c-2.208 0-4-1.792-4-4s1.792-4 4-4 4 1.792 4 4-1.792 4-4 4zm4.865-10.45c0 .69-.56 1.25-1.25 1.25s-1.25-.56-1.25-1.25.56-1.25 1.25-1.25 1.25.56 1.25 1.25z"/></svg></a>
                        <a href="#" target="_blank" title="WhatsApp"><svg viewBox="0 0 24 24"><path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2 22l5.25-1.38c1.45.79 3.08 1.21 4.79 1.21h.01c5.46 0 9.91-4.45 9.91-9.91s-4.45-9.91-9.91-9.91zM12.04 20.13h-.01c-1.53 0-3.03-.4-4.36-1.15l-.31-.18-3.24.85.87-3.17-.2-.33c-.83-1.38-1.28-2.97-1.28-4.66 0-4.4 3.58-7.98 7.98-7.98 4.4 0 7.98 3.58 7.98 7.98-.01 4.4-3.58 7.98-7.97 7.98zm4.53-6.2c-.25-.12-1.47-.72-1.7-.82-.22-.09-.38-.12-.54.12-.16.25-.64.82-.79.98-.15.16-.29.18-.54.06-.25-.12-1.05-.39-2-1.23-.74-.66-1.23-1.47-1.38-1.72s-.02-.38.11-.5l.23-.26c.1-.12.16-.21.25-.35.09-.14.04-.26-.02-.38-.06-.12-.54-1.3-.74-1.78-.19-.48-.39-.42-.53-.43h-.48c-.16 0-.42.06-.64.3.22.25-.87 1.03-1.07 2.47-.64 1.1 1.03 2.2 1.18 2.47.15.25 1.75 2.8 4.24 3.72.59.21 1.04.34 1.4.44.56.14 1.07.12 1.47.07.45-.05 1.47-.6 1.68-1.18.21-.58.21-1.08.15-1.18-.07-.1-.22-.16-.47-.28z"/></svg></a>
                        <a href="#" target="_blank" title="Twitter"><svg viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.67.88-.53 1.56-1.37 1.88-2.38-.83.49-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.58-.7-.02-1.37-.21-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.94.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.01-.06C3.18 19.25 5.23 20 7.48 20c8.97 0 13.87-7.44 13.87-13.87 0-.21 0-.42-.01-.63.95-.69 1.78-1.56 2.45-2.54z"/></svg></a>
                    </div>
                </div>
            </div>
            <!-- Profile 2 -->
            <div class="profile-card">
                <img src="https://iili.io/f9dyma1.jpg" alt="Foto Ahmad Rafael">
                <div class="profile-details">
                    <h4>Ahmad Rafael Gerald Yosiano</h4>
                    <span class="role">Data & Marine Ecology Specialist</span>
                    <p class="interest">üéì Berminat di bidang Ekologi Kelautan serta Olahraga Air, memastikan data kami relevan secara ekologis.</p>
                    <div class="social-links">
                        <a href="#" target="_blank" title="Instagram"><svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.264.057 2.15.247 2.91.556.786.31 1.457.718 2.123 1.385.667.666 1.076 1.337 1.385 2.123.31.76.5 1.646.558 2.91.058 1.267.07 1.647.07 4.85s-.012 3.584-.07 4.85c-.058 1.264-.248 2.15-.558 2.91-.31.786-.718 1.457-1.385 2.123-.666.667-1.337 1.076-2.123 1.385-.76.31-1.646.5-2.91.558-1.267.058-1.647.07-4.85.07s-3.584-.012-4.85-.07c-1.264-.057-2.15-.247-2.91-.558-.786-.31-1.457-.718-2.123-1.385-.667-.666-1.076-1.337-1.385-2.123-.31-.76-.5-1.646-.558-2.91-.058-1.267-.07-1.647-.07-4.85s.012-3.584.07-4.85c.058-1.264.248-2.15.558-2.91.31-.786.718-1.457 1.385-2.123.666-.667 1.337-1.076 2.123-1.385.76-.31 1.646-.5 2.91-.558C8.416 2.175 8.796 2.163 12 2.163zm0 1.802c-3.144 0-3.486.01-4.698.067-1.19.055-1.89.232-2.428.45- .56.227-.96.517-1.38.938-.42.42-.71.82-.938 1.38-.218.538-.4 1.237-.45 2.428C2.175 8.514 2.163 8.856 2.163 12s.01 3.486.067 4.698c.055 1.19.232 1.89.45 2.428.227.56.517.96.938 1.38.42.42.82.71 1.38.938.538.218 1.237.4 2.428.45 1.212.057 1.554.067 4.698.067s3.486-.01 4.698-.067c1.19-.055 1.89-.232 2.428-.45.56-.227.96-.517 1.38-.938.42-.42.71-.82.938-1.38.218-.538.4-1.237-.45-2.428.057-1.212.067-1.554.067-4.698s-.01-3.486-.067-4.698c-.055-1.19-.232-1.89-.45-2.428-.227-.56-.517-.96-.938-1.38-.42-.42-.82-.71-1.38-.938-.538-.218-1.237-.4-2.428-.45-1.212-.057-1.554-.067-4.698-.067zm0 3.67c-3.405 0-6.162 2.757-6.162 6.162s2.757 6.162 6.162 6.162 6.162-2.757 6.162-6.162-2.757-6.162-6.162-6.162zm0 10.16c-2.208 0-4-1.792-4-4s1.792-4 4-4 4 1.792 4 4-1.792 4-4 4zm4.865-10.45c0 .69-.56 1.25-1.25 1.25s-1.25-.56-1.25-1.25.56-1.25 1.25-1.25 1.25.56 1.25 1.25z"/></svg></a>
                        <a href="#" target="_blank" title="WhatsApp"><svg viewBox="0 0 24 24"><path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2 22l5.25-1.38c1.45.79 3.08 1.21 4.79 1.21h.01c5.46 0 9.91-4.45 9.91-9.91s-4.45-9.91-9.91-9.91zM12.04 20.13h-.01c-1.53 0-3.03-.4-4.36-1.15l-.31-.18-3.24.85.87-3.17-.2-.33c-.83-1.38-1.28-2.97-1.28-4.66 0-4.4 3.58-7.98 7.98-7.98 4.4 0 7.98 3.58 7.98 7.98-.01 4.4-3.58 7.98-7.97 7.98zm4.53-6.2c-.25-.12-1.47-.72-1.7-.82-.22-.09-.38-.12-.54.12-.16.25-.64.82-.79.98-.15.16-.29.18-.54.06-.25-.12-1.05-.39-2-1.23-.74-.66-1.23-1.47-1.38-1.72s-.02-.38.11-.5l.23-.26c.1-.12.16-.21.25-.35.09-.14.04-.26-.02-.38-.06-.12-.54-1.3-.74-1.78-.19-.48-.39-.42-.53-.43h-.48c-.16 0-.42.06-.64.3.22.25-.87 1.03-1.07 2.47-.64 1.1 1.03 2.2 1.18 2.47.15.25 1.75 2.8 4.24 3.72.59.21 1.04.34 1.4.44.56.14 1.07.12 1.47.07.45-.05 1.47-.6 1.68-1.18.21-.58.21-1.08.15-1.18-.07-.1-.22-.16-.47-.28z"/></svg></a>
                        <a href="#" target="_blank" title="Twitter"><svg viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.67.88-.53 1.56-1.37 1.88-2.38-.83.49-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.58-.7-.02-1.37-.21-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.94.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.01-.06C3.18 19.25 5.23 20 7.48 20c8.97 0 13.87-7.44 13.87-13.87 0-.21 0-.42-.01-.63.95-.69 1.78-1.56 2.45-2.54z"/></svg></a>
                    </div>
                </div>
            </div>
            <!-- Profile 3 -->
            <div class="profile-card">
                <img src="https://iili.io/f9dyyyg.jpg" alt="Foto Mega Aulia">
                <div class="profile-details">
                    <h4>Mega Aulia Ramadhan</h4>
                    <span class="role">Community & Content</span>
                    <p class="interest">üéì Berminat pada Olahraga dan Kesenian, berperan dalam penyampaian konten yang menarik.</p>
                    <div class="social-links">
                        <a href="#" target="_blank" title="Instagram"><svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.264.057 2.15.247 2.91.556.786.31 1.457.718 2.123 1.385.667.666 1.076 1.337 1.385 2.123.31.76.5 1.646.558 2.91.058 1.267.07 1.647.07 4.85s-.012 3.584-.07 4.85c-.058 1.264-.248 2.15-.558 2.91-.31.786-.718 1.457-1.385 2.123-.666.667-1.337 1.076-2.123 1.385-.76.31-1.646.5-2.91.558-1.267.058-1.647.07-4.85.07s-3.584-.012-4.85-.07c-1.264-.057-2.15-.247-2.91-.558-.786-.31-1.457-.718-2.123-1.385-.667-.666-1.076-1.337-1.385-2.123-.31-.76-.5-1.646-.558-2.91-.058-1.267-.07-1.647-.07-4.85s.012-3.584.07-4.85c.058-1.264.248-2.15.558-2.91.31-.786.718-1.457 1.385-2.123.666-.667 1.337-1.076 2.123-1.385.76-.31 1.646-.5 2.91-.558C8.416 2.175 8.796 2.163 12 2.163zm0 1.802c-3.144 0-3.486.01-4.698.067-1.19.055-1.89.232-2.428.45- .56.227-.96.517-1.38.938-.42.42-.71.82-.938 1.38-.218.538-.4 1.237-.45 2.428C2.175 8.514 2.163 8.856 2.163 12s.01 3.486.067 4.698c.055 1.19.232 1.89.45 2.428.227.56.517.96.938 1.38.42.42.82.71 1.38.938.538.218 1.237.4 2.428.45 1.212.057 1.554.067 4.698.067s3.486-.01 4.698-.067c1.19-.055 1.89-.232 2.428-.45.56-.227.96-.517 1.38-.938.42-.42.71-.82.938-1.38.218-.538.4-1.237-.45-2.428.057-1.212.067-1.554.067-4.698s-.01-3.486-.067-4.698c-.055-1.19-.232-1.89-.45-2.428-.227-.56-.517-.96-.938-1.38-.42-.42-.82-.71-1.38-.938-.538-.218-1.237-.4-2.428-.45-1.212-.057-1.554-.067-4.698-.067zm0 3.67c-3.405 0-6.162 2.757-6.162 6.162s2.757 6.162 6.162 6.162 6.162-2.757 6.162-6.162-2.757-6.162-6.162-6.162zm0 10.16c-2.208 0-4-1.792-4-4s1.792-4 4-4 4 1.792 4 4-1.792 4-4 4zm4.865-10.45c0 .69-.56 1.25-1.25 1.25s-1.25-.56-1.25-1.25.56-1.25 1.25-1.25 1.25.56 1.25 1.25z"/></svg></a>
                        <a href="#" target="_blank" title="WhatsApp"><svg viewBox="0 0 24 24"><path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2 22l5.25-1.38c1.45.79 3.08 1.21 4.79 1.21h.01c5.46 0 9.91-4.45 9.91-9.91s-4.45-9.91-9.91-9.91zM12.04 20.13h-.01c-1.53 0-3.03-.4-4.36-1.15l-.31-.18-3.24.85.87-3.17-.2-.33c-.83-1.38-1.28-2.97-1.28-4.66 0-4.4 3.58-7.98 7.98-7.98 4.4 0 7.98 3.58 7.98 7.98-.01 4.4-3.58 7.98-7.97 7.98zm4.53-6.2c-.25-.12-1.47-.72-1.7-.82-.22-.09-.38-.12-.54.12-.16.25-.64.82-.79.98-.15.16-.29.18-.54.06-.25-.12-1.05-.39-2-1.23-.74-.66-1.23-1.47-1.38-1.72s-.02-.38.11-.5l.23-.26c.1-.12.16-.21.25-.35.09-.14.04-.26-.02-.38-.06-.12-.54-1.3-.74-1.78-.19-.48-.39-.42-.53-.43h-.48c-.16 0-.42.06-.64.3.22.25-.87 1.03-1.07 2.47-.64 1.1 1.03 2.2 1.18 2.47.15.25 1.75 2.8 4.24 3.72.59.21 1.04.34 1.4.44.56.14 1.07.12 1.47.07.45-.05 1.47-.6 1.68-1.18.21-.58.21-1.08.15-1.18-.07-.1-.22-.16-.47-.28z"/></svg></a>
                        <a href="#" target="_blank" title="Twitter"><svg viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.67.88-.53 1.56-1.37 1.88-2.38-.83.49-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.58-.7-.02-1.37-.21-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.94.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.01-.06C3.18 19.25 5.23 20 7.48 20c8.97 0 13.87-7.44 13.87-13.87 0-.21 0-.42-.01-.63.95-.69 1.78-1.56 2.45-2.54z"/></svg></a>
                    </div>
                </div>
            </div>
            <!-- Profile 4 -->
            <div class="profile-card">
                <img src="https://iili.io/f9dyp8F.jpg" alt="Foto Diana Sadira">
                <div class="profile-details">
                    <h4>Diana Sadira Yakub</h4>
                    <span class="role">UI/UX Designer</span>
                    <p class="interest">üéì Berminat di bidang Desain Visual, memastikan platform ini mudah dan nyaman digunakan.</p>
                    <div class="social-links">
                        <a href="#" target="_blank" title="Instagram"><svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.264.057 2.15.247 2.91.556.786.31 1.457.718 2.123 1.385.667.666 1.076 1.337 1.385 2.123.31.76.5 1.646.558 2.91.058 1.267.07 1.647.07 4.85s-.012 3.584-.07 4.85c-.058 1.264-.248 2.15-.558 2.91-.31.786-.718 1.457-1.385 2.123-.666.667-1.337 1.076-2.123 1.385-.76.31-1.646-.5-2.91-.558-1.267.058-1.647.07-4.85.07s-3.584-.012-4.85-.07c-1.264-.057-2.15-.247-2.91-.558-.786-.31-1.457-.718-2.123-1.385-.667-.666-1.076-1.337-1.385-2.123-.31-.76-.5-1.646-.558-2.91-.058-1.267-.07-1.647-.07-4.85s.012-3.584.07-4.85c.058-1.264.248-2.15.558-2.91.31-.786.718-1.457 1.385-2.123.666-.667 1.337-1.076 2.123-1.385.76-.31 1.646-.5 2.91-.558C8.416 2.175 8.796 2.163 12 2.163zm0 1.802c-3.144 0-3.486.01-4.698.067-1.19.055-1.89.232-2.428.45- .56.227-.96.517-1.38.938-.42.42-.71.82-.938 1.38-.218.538-.4 1.237-.45 2.428C2.175 8.514 2.163 8.856 2.163 12s.01 3.486.067 4.698c.055 1.19.232 1.89.45 2.428.227.56.517.96.938 1.38.42.42.82.71 1.38.938.538.218 1.237.4 2.428.45 1.212.057 1.554.067 4.698.067s3.486-.01 4.698-.067c1.19-.055 1.89-.232 2.428-.45.56-.227.96-.517 1.38-.938.42-.42.71-.82.938-1.38.218-.538.4-1.237-.45-2.428.057-1.212.067-1.554.067-4.698s-.01-3.486-.067-4.698c-.055-1.19-.232-1.89-.45-2.428-.227-.56-.517-.96-.938-1.38-.42-.42-.82-.71-1.38-.938-.538-.218-1.237-.4-2.428-.45-1.212-.057-1.554-.067-4.698-.067zm0 3.67c-3.405 0-6.162 2.757-6.162 6.162s2.757 6.162 6.162 6.162 6.162-2.757 6.162-6.162-2.757-6.162-6.162-6.162zm0 10.16c-2.208 0-4-1.792-4-4s1.792-4 4-4 4 1.792 4 4-1.792 4-4 4zm4.865-10.45c0 .69-.56 1.25-1.25 1.25s-1.25-.56-1.25-1.25.56-1.25 1.25-1.25 1.25.56 1.25 1.25z"/></svg></a>
                        <a href="#" target="_blank" title="WhatsApp"><svg viewBox="0 0 24 24"><path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2 22l5.25-1.38c1.45.79 3.08 1.21 4.79 1.21h.01c5.46 0 9.91-4.45 9.91-9.91s-4.45-9.91-9.91-9.91zM12.04 20.13h-.01c-1.53 0-3.03-.4-4.36-1.15l-.31-.18-3.24.85.87-3.17-.2-.33c-.83-1.38-1.28-2.97-1.28-4.66 0-4.4 3.58-7.98 7.98-7.98 4.4 0 7.98 3.58 7.98 7.98-.01 4.4-3.58 7.98-7.97 7.98zm4.53-6.2c-.25-.12-1.47-.72-1.7-.82-.22-.09-.38-.12-.54.12-.16.25-.64.82-.79.98-.15.16-.29.18-.54.06-.25-.12-1.05-.39-2-1.23-.74-.66-1.23-1.47-1.38-1.72s-.02-.38.11-.5l.23-.26c.1-.12.16-.21.25-.35.09-.14.04-.26-.02-.38-.06-.12-.54-1.3-.74-1.78-.19-.48-.39-.42-.53-.43h-.48c-.16 0-.42.06-.64.3.22.25-.87 1.03-1.07 2.47-.64 1.1 1.03 2.2 1.18 2.47.15.25 1.75 2.8 4.24 3.72.59.21 1.04.34 1.4.44.56.14 1.07.12 1.47.07.45-.05 1.47-.6 1.68-1.18.21-.58.21-1.08.15-1.18-.07-.1-.22-.16-.47-.28z"/></svg></a>
                        <a href="#" target="_blank" title="Twitter"><svg viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.67.88-.53 1.56-1.37 1.88-2.38-.83.49-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.58-.7-.02-1.37-.21-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.94.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.01-.06C3.18 19.25 5.23 20 7.48 20c8.97 0 13.87-7.44 13.87-13.87 0-.21 0-.42-.01-.63.95-.69 1.78-1.56 2.45-2.54z"/></svg></a>
                    </div>
                </div>
            </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="hidden" style="padding:12px">
    <div class="footer-col">
      <div class="footer-title" data-i18n="footer_marine_title">Marine Info</div>
      <div class="small">Name: Mahasiswa UPI Serang</div>
      <div class="small">Phone: +62 813-1732-0204</div>
      <div style="margin-top:8px">
        <strong data-i18n="footer_report_illegal">Report illegal fishing:</strong><br/>
        <a class="small" href="https://www.instagram.com/kp3k_kpdk" target="_blank">IG Dinas Kelautan</a> ‚Ä¢
        <a class="small" href="https://wa.me/6281234567890" target="_blank">WhatsApp Dinas</a>
      </div>
    </div>

    <div class="footer-col">
      <div class="footer-title" data-i18n="footer_feedback_title">Feedback (Phone)</div>
      <form id="feedback-form" onsubmit="event.preventDefault(); saveFeedbackLocal();">
        <input id="fb-phone" data-i18n-placeholder="footer_phone_placeholder" placeholder="Phone number (required)" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(10,20,40,0.06)"/>
        <textarea id="fb-message" data-i18n-placeholder="footer_message_placeholder" placeholder="Message" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(10,20,40,0.06);margin-top:8px"></textarea>
        <div class="footer-actions">
          <button type="submit" class="btn primary" data-i18n="footer_send">Send</button>
          <button type="button" id="save-local" class="btn" data-i18n="footer_save_local">Save Local</button>
        </div>
        <div id="fb-status" class="small" style="margin-top:6px"></div>
      </form>
    </div>

    <div class="footer-col">
      <div class="footer-title" data-i18n="footer_manage_title">Manage</div>
      <div class="footer-actions">
        <button id="export-data" class="btn" data-i18n="footer_export_data">Export Data</button>
        <button id="import-data" class="btn" data-i18n="footer_import_data">Import Data</button>
        <button id="hide-footer" class="btn" data-i18n="footer_hide">Hide Footer</button>
      </div>
      <div style="margin-top:8px" class="small" data-i18n="footer_comfort">Theme & language set for user comfort.</div>
    </div>
  </footer>

  <button id="show-footer" style="position:fixed;right:18px;bottom:18px;padding:10px 14px;border-radius:999px;background:var(--nav);color:#fff;border:none;z-index:1600" data-i18n="footer_show">Show Footer</button>

<script>
/* ================= Global State & Config ================= */
let randomizeOn = true;
let allZoneMarkers = []; // Master list of all markers for robust filtering
let lang = 'en';
let weatherChart = null;

// Fish movement variables
let fishMovementActive = false;
let fishMovementInterval = null;
let fishSpeed = 3; // Default speed (1-10)
let movingFishMarkers = [];

// STATIC FISH DATA (Not tied to language)
const FISH_DATA = [
    {name:'Tuna Sirip Kuning', desc:'Ikan pelagis besar populer', price:'Rp 60rb-150rb/kg', locations:'Laut Banda, Flores', habitat:'Oseanik', season:'Sepanjang tahun', type: 'saltwater'},
    {name:'Cakalang', desc:'Penting untuk industri pengalengan', price:'Rp 25rb-45rb/kg', locations:'Laut Sulawesi, Maluku', habitat:'Epipelagik', season:'Sepanjang tahun', type: 'saltwater'},
    {name:'Tongkol', desc:'Kerabat tuna, sering dipindang', price:'Rp 20rb-40rb/kg', locations:'Seluruh perairan', habitat:'Pesisir & laut lepas', season:'Musim hujan', type: 'saltwater'},
    {name:'Kakap Merah', desc:'Ikan demersal bernilai tinggi', price:'Rp 70rb-120rb/kg', locations:'Selat Malaka, Laut Jawa', habitat:'Dasar berbatu, karang', season:'Pancaroba', type: 'saltwater'},
    {name:'Kerapu Macan', desc:'Predator dasar laut favorit restoran', price:'Rp 80rb-200rb/kg', locations:'Raja Ampat, Wakatobi', habitat:'Terumbu karang', season:'Sepanjang tahun', type: 'saltwater'},
    {name:'Tenggiri', desc:'Ikan pelagis cepat untuk pempek', price:'Rp 70rb-110rb/kg', locations:'Laut Jawa, Selat Sunda', habitat:'Dekat permukaan', season:'Musim kemarau', type: 'saltwater'},
    {name:'Bawal Putih', desc:'Ikan gepeng bernilai ekonomis tinggi', price:'Rp 90rb-150rb/kg', locations:'Pesisir utara Jawa', habitat:'Dasar lumpur/pasir', season:'Akhir musim hujan', type: 'saltwater'},
    {name:'Baronang', desc:'Ikan herbivora di terumbu karang', price:'Rp 50rb-80rb/kg', locations:'Kepulauan Seribu, Bali', habitat:'Padang lamun, karang', season:'Sepanjang tahun', type: 'saltwater'},
    {name:'Kembung', desc:'Ikan kecil populer konsumsi harian', price:'Rp 30rb-50rb/kg', locations:'Seluruh perairan pesisir', habitat:'Pesisir, berkelompok', season:'Musim hujan', type: 'saltwater'},
    {name:'Layur', desc:'Ikan panjang keperakan, daging gurih', price:'Rp 25rb-45rb/kg', locations:'Pesisir selatan Jawa', habitat:'Dasar laut dalam', season:'Musim kemarau', type: 'saltwater'},
    {name:'Teri Nasi', desc:'Ikan kecil untuk ikan asin/sambal', price:'Rp 50rb-90rb/kg (kering)', locations:'Bagan Siapi-api, pesisir', habitat:'Permukaan pesisir', season:'Musim kemarau', type: 'saltwater'},
    {name:'Belanak', desc:'Sering ditemukan di area muara', price:'Rp 30rb-50rb/kg', locations:'Muara di Jawa, Sumatera', habitat:'Air payau, muara', season:'Awal musim hujan', type: 'saltwater'},
    {name:'Bandeng', desc:'Populer di tambak, banyak duri', price:'Rp 25rb-40rb/kg', locations:'Tambak Pantura, Sulsel', habitat:'Air payau, tambak', season:'Sepanjang tahun', type: 'saltwater'},
    {name:'Rajungan', desc:'Kepiting laut dengan daging manis', price:'Rp 70rb-130rb/kg', locations:'Pesisir utara Jawa', habitat:'Dasar pasir/lumpur', season:'Sepanjang tahun', type: 'saltwater'},
    {name:'Ikan Kuwe', desc:'Predator kuat yang bergerombol', price:'Rp 45rb-70rb/kg', locations:'Perairan karang', habitat:'Sekitar karang, atol', season:'Sepanjang tahun', type: 'saltwater'},
    {name:'Selar', desc:'Ikan kecil, sering diasinkan', price:'Rp 25rb-40rb/kg', locations:'Seluruh perairan pesisir', habitat:'Pesisir, bergerombol', season:'Musim kemarau', type: 'saltwater'},
    {name:'Lemuru', desc:'Sarden versi Indonesia', price:'Rp 15rb-30rb/kg', locations:'Selat Bali', habitat:'Pelagis pesisir', season:'Sept-Feb', type: 'saltwater'},
    {name:'Lobster Mutiara', desc:'Krustasea premium harga tinggi', price:'Rp 300rb-1jt+/kg', locations:'Pesisir selatan Jawa, Lombok', habitat:'Dasar karang berbatu', season:'Diatur ketat', type: 'saltwater'},
    {name:'Cumi-cumi', desc:'Moluska cerdas nilai ekonomi tinggi', price:'Rp 60rb-100rb/kg', locations:'Laut Jawa, Kep. Riau', habitat:'Pesisir hingga laut dalam', season:'Musim pancaroba', type: 'saltwater'},
    {name:'Sotong', desc:'Kerabat cumi dengan cangkang internal', price:'Rp 50rb-90rb/kg', locations:'Seluruh perairan', habitat:'Dasar laut dangkal', season:'Sepanjang tahun', type: 'saltwater'},
    {name:'Gurame', desc:'Ikan air tawar populer untuk dibakar', price:'Rp 50rb-80rb/kg', locations:'Sungai/danau Jawa, Sumatera', habitat:'Air tenang, rawa', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Lele Dumbo', desc:'Sangat umum dibudidayakan', price:'Rp 20rb-35rb/kg', locations:'Budidaya seluruh Indonesia', habitat:'Kolam, rawa, sungai', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Patin', desc:'Daging lembut, sering dibuat sup', price:'Rp 40rb-70rb/kg', locations:'Sungai besar Sumatera, Kalimantan', habitat:'Sungai besar', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Nila', desc:'Kerabat Tilapia, mudah dibudidayakan', price:'Rp 25rb-40rb/kg', locations:'Danau/waduk seluruh Indonesia', habitat:'Danau, air tenang', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Ikan Mas', desc:'Ikan umum untuk pemancingan & konsumsi', price:'Rp 30rb-50rb/kg', locations:'Kolam/danau di Jawa', habitat:'Air tawar tenang', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Gabus', desc:'Predator air tawar, baik untuk penyembuhan luka', price:'Rp 60rb-90rb/kg', locations:'Rawa & sungai seluruh Indonesia', habitat:'Rawa, danau, parit', season:'Musim hujan', type: 'freshwater'},
    {name:'Sidat', desc:'Belut yg migrasi ke laut untuk berkembang biak', price:'Rp 150rb-400rb/kg', locations:'Sungai di Jawa, Sulawesi', habitat:'Air tawar, payau, laut', season:'Musim hujan', type: 'freshwater'},
    {name:'Baung', desc:'Jenis lele dengan nilai ekonomis tinggi', price:'Rp 50rb-80rb/kg', locations:'Sungai-sungai besar Sumatera', habitat:'Dasar sungai', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Sepat Siam', desc:'Ikan konsumsi dan hias, sering diasinkan', price:'Rp 20rb-40rb/kg', locations:'Rawa dan persawahan', habitat:'Air tergenang, rawa', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Mujair', desc:'Ikan introduksi yang sudah meluas', price:'Rp 25rb-45rb/kg', locations:'Danau & waduk seluruh Indonesia', habitat:'Beragam air tawar', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Tawes', desc:'Ikan herbivora, sering dibudidayakan', price:'Rp 20rb-35rb/kg', locations:'Sungai dan danau di Jawa', habitat:'Sungai, rawa', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Belida', desc:'Ikan pipih untuk kerupuk, terancam', price:'Bervariasi (dilindungi)', locations:'Sungai besar Sumatera, Kalimantan', habitat:'Sungai, danau', season:'Dilindungi', type: 'freshwater'},
    {name:'Hampala', desc:'Ikan predator asli sungai Indonesia', price:'N/A (sport fishing)', locations:'Sungai deras di Jawa, Sumatera', habitat:'Sungai air jernih', season:'Musim kemarau', type: 'freshwater'},
    {name:'Wader Pari', desc:'Ikan kecil yang hidup berkelompok', price:'Rp 20rb-30rb/kg (goreng)', locations:'Sungai-sungai di Jawa', habitat:'Perairan mengalir', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Tambakan', desc:'Dikenal sebagai "Kissing Gourami"', price:'Rp 25rb-40rb/kg', locations:'Rawa di Sumatera, Kalimantan', habitat:'Rawa, air tenang', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Betok', desc:'Ikan yg bisa memanjat, tahan kondisi ekstrem', price:'Rp 30rb-50rb/kg', locations:'Rawa, parit, sawah', habitat:'Air diam/sedikit oksigen', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Udang Galah', desc:'Udang air tawar terbesar', price:'Rp 100rb-200rb/kg', locations:'Sungai-sungai besar', habitat:'Dasar sungai', season:'Musim hujan', type: 'freshwater'},
    {name:'Arwana', desc:'Ikan hias ikonik, dilindungi', price:'Sangat tinggi (hias)', locations:'Sungai di Kalimantan, Papua', habitat:'Sungai berarus lambat', season:'Dilindungi', type: 'freshwater'},
    {name:'Bogo', desc:'Kerabat gabus berukuran lebih kecil', price:'Rp 20rb-35rb/kg', locations:'Parit dan sawah', habitat:'Perairan dangkal', season:'Sepanjang tahun', type: 'freshwater'},
    {name:'Kakap Putih', desc:'Barramundi, hidup di air payau dan tawar', price:'Rp 60rb-100rb/kg', locations:'Pesisir Kalimantan, Papua', habitat:'Muara sungai, pesisir', season:'Musim hujan', type: 'freshwater'}
];

// Weather conditions for simulation
const WEATHER_CONDITIONS = [
  { icon: '‚òÄÔ∏è', desc: 'Clear Sky' },
  { icon: '‚õÖ', desc: 'Partly Cloudy' },
  { icon: '‚òÅÔ∏è', desc: 'Cloudy' },
  { icon: 'üåßÔ∏è', desc: 'Rainy' },
  { icon: '‚õàÔ∏è', desc: 'Thunderstorm' },
  { icon: 'üåä', desc: 'Rough Seas' }
];

const LANGS = {
  en: {
    // UI Texts
    search_placeholder: "Search location (e.g. Pacific Ocean or '12.34, 56.78')",
    btn_search: "Search", btn_home: "Home", generate: "Generate Zones", load_geo: "Load GeoJSON", export_fav: "Export Favorites", clear_reports: "Clear Reports", toggle_random: "Toggle Random", regen: "Regenerate", random_on: "‚è± Random ON", random_off: "‚è± Random OFF", btn_all_feature: "All Features",
    header_subtitle: "Web Helper to assist fishermen in catching fish and preserving the sea",
    nav_home: "Home", nav_map: "Map", nav_weather: "Weather", nav_info: "Fish Info", nav_about: "About", nav_theme: "üåì Theme",
    map_zone_filters: "Zone Filters", map_green_safe: "Green ‚Äî Safe", map_yellow_caution: "Yellow ‚Äî Caution", map_red_restricted: "Red ‚Äî Restricted",
    map_quick_tips: "Quick Tips", map_tip_report: "Press <strong>R</strong> to enter report mode, then click a location on the map to add a catch report.",
    map_tip_forecast: "Click any zone to view simulated marine forecast and safety advice.",
    map_forecast_title: "Marine Forecast & Safety", map_panel_close: "Close", map_panel_open: "Open",
    safety_click: "Click a zone or map point to simulate marine forecast & receive safety advice.",
    map_refresh_forecast: "Refresh Forecast", map_auto_update: "Enable real-time updates", map_legend: "Legend",
    info_title: "Fish Info", info_saltwater_title: "Saltwater Fish", info_freshwater_title: "Freshwater Fish",
    info_th_name: "Name", info_th_desc: "Description", info_th_price: "Price", info_th_locations: "Common Locations", info_th_habitat: "Habitat", info_th_season: "Best Season",
    weather_title: "Marine Weather Forecast",
    weather_forecast_title: "5-Day Forecast",
    weather_marine_title: "Marine Conditions",
    footer_marine_title: "Marine Info", footer_report_illegal: "Report illegal fishing:", footer_feedback_title: "Feedback (Phone)", footer_phone_placeholder: "Phone number (required)", footer_message_placeholder: "Message", footer_send: "Send", footer_save_local: "Save Local",
    footer_manage_title: "Manage", footer_export_data: "Export Data", footer_import_data: "Import Data", footer_hide: "Hide Footer", footer_show: "Show Footer", footer_comfort: "Theme & language set for user comfort.",
    // JS Messages
    feedback_saved: "Feedback saved locally.", alert_geojson_local_loaded: "Loaded local GeoJSON.", alert_invalid_file: "Invalid file.", alert_geojson_url_loaded: "Loaded GeoJSON from URL.", alert_geojson_failed: "Failed to load GeoJSON (CORS or invalid).", alert_added_favorites: "Added to favorites.", alert_removed_favorites: "Removed from favorites.", alert_no_favorites: "No favorite zones selected from GeoJSON.", alert_report_mode_on: "Report mode ON ‚Äî click map to add catch report.", prompt_species_caught: "Species caught (required):", prompt_weight_optional: "Weight (kg) ‚Äî optional:", alert_canceled: "Canceled.", alert_report_saved: "Report saved locally.", confirm_clear_reports: "Clear all local reports?", alert_cleared: "Cleared.", alert_enter_search: "Enter search.", alert_not_found: "Not found.", alert_search_failed: "Search failed.", alert_phone_required: "Phone number is required.", alert_imported_locally: "Imported locally.",
  },
  id: {
    // UI Texts
    search_placeholder: "Cari lokasi (mis. Samudra Pasifik atau '12.34, 56.78')",
    btn_search: "Cari", btn_home: "Beranda", generate: "Buat Zona", load_geo: "Muat GeoJSON", export_fav: "Ekspor Favorit", clear_reports: "Bersihkan Laporan", toggle_random: "Acak Aktif/Mati", regen: "Buat Ulang", random_on: "‚è± Acak AKTIF", random_off: "‚è± Acak MATI", btn_all_feature: "Semua Fitur",
    header_subtitle: "Web Helper untuk membantu nelayan dalam menangkap ikan serta melestarikan laut",
    nav_home: "Beranda", nav_map: "Peta", nav_weather: "Cuaca", nav_info: "Info Ikan", nav_about: "Tentang", nav_theme: "üåì Tema",
    map_zone_filters: "Filter Zona", map_green_safe: "Hijau ‚Äî Aman", map_yellow_caution: "Kuning ‚Äî Hati-hati", map_red_restricted: "Merah ‚Äî Terlarang",
    map_quick_tips: "Tips Cepat", map_tip_report: "Tekan <strong>R</strong> untuk masuk mode laporan, lalu klik lokasi di peta untuk menambah laporan tangkapan.",
    map_tip_forecast: "Klik zona mana pun untuk melihat perkiraan laut simulasi dan saran keselamatan.",
    map_forecast_title: "perkiraan Laut & Keselamatan", map_panel_close: "Tutup", map_panel_open: "Buka",
    safety_click: "Klik zona atau titik peta untuk menjajal perkiraan laut & saran keselamatan.",
    map_refresh_forecast: "Segarkan perkiraan", map_auto_update: "Aktifkan pembaruan real-time", map_legend: "Legenda",
    info_title: "Info Ikan", info_saltwater_title: "Ikan Air Asin", info_freshwater_title: "Ikan Air Tawar",
    info_th_name: "Nama", info_th_desc: "Deskripsi", info_th_price: "Harga", info_th_locations: "Lokasi Umum", info_th_habitat: "Habitat", info_th_season: "Musim Terbaik",
    weather_title: "Perkiraan Cuaca Maritim",
    weather_forecast_title: "Perkiraan 5 Hari",
    weather_marine_title: "Kondisi Maritim",
    footer_marine_title: "Info Kelautan", footer_report_illegal: "Laporkan penangkapan ikan ilegal:", footer_feedback_title: "Umpan Balik (Telepon)", footer_phone_placeholder: "Nomor telepon (wajib)", footer_message_placeholder: "Pesan", footer_send: "Kirim", footer_save_local: "Simpan Lokal",
    footer_manage_title: "Kelola", footer_export_data: "Ekspor Data", footer_import_data: "Impor Data", footer_hide: "Sembunyikan Footer", footer_show: "Tampilkan Footer", footer_comfort: "Tema & bahasa diatur untuk kenyamanan pengguna.",
    // JS Messages (Same as English for simplicity)
  },
  // Other languages omitted for brevity
};

/* ================= i18n Functions (SIMPLIFIED) ================= */
const langSelect = document.getElementById('lang-select');
langSelect.addEventListener('change', (e)=>{ lang = e.target.value; applyI18n(); });
function t(key){ return (LANGS[lang] && LANGS[lang][key]) || (LANGS['en'][key]) || key; }

function populateFishTable() {
  const tbodySaltwater = document.querySelector('#fish-table-saltwater tbody');
  const tbodyFreshwater = document.querySelector('#fish-table-freshwater tbody');

  tbodySaltwater.innerHTML = '';
  tbodyFreshwater.innerHTML = '';

  FISH_DATA.forEach(f => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${f.name}</td><td>${f.desc}</td><td>${f.price}</td><td>${f.locations}</td><td>${f.habitat}</td><td>${f.season}</td>`;
    
    if (f.type === 'saltwater') {
      tbodySaltwater.appendChild(tr);
    } else if (f.type === 'freshwater') {
      tbodyFreshwater.appendChild(tr);
    }
  });
}

function applyI18n(){
  document.querySelectorAll('[data-i18n]').forEach(el => el.innerHTML = t(el.getAttribute('data-i18n')));
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => el.placeholder = t(el.getAttribute('data-i18n-placeholder')));
  document.querySelectorAll('[data-i18n-title]').forEach(el => el.title = t(el.getAttribute('data-i18n-title')));
  
  document.getElementById('toggle-random').textContent = randomizeOn ? t('random_on') : t('random_off');
  const togglePanelBtn = document.getElementById('toggle-panel');
  togglePanelBtn.textContent = document.getElementById('rightPanel').classList.contains('closed') ? t('map_panel_open') : t('map_panel_close');
}

/* ================= Slideshow ================= */
const slides = document.querySelectorAll('.bg-slide');
let slideIndex = 0;
setInterval(()=> {
  slides[slideIndex].classList.remove('active');
  slideIndex = (slideIndex + 1) % slides.length;
  slides[slideIndex].classList.add('active');
}, 7000);

/* ================= Intro screen ================= */
const intro = document.getElementById('intro-screen');
document.getElementById('start-btn').addEventListener('click', ()=> {
  intro.style.opacity = 0;
  setTimeout(()=> { intro.style.display = 'none'; }, 600);
});

/* ================= Map setup (Esri World_Imagery) ================= */
const map = L.map('map', { worldCopyJump:true, preferCanvas: true }).setView([-2, 118], 5); // Center on Indonesia
const tileEsri = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { attribution: '&copy; Esri, Maxar' });
const tileOSM = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; OpenStreetMap' });
const tileDark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{y}{r}.png');
tileEsri.addTo(map);
tileEsri.on('tileerror', ()=>{ if(!map.hasLayer(tileOSM)) tileOSM.addTo(map); });

document.getElementById('toggle-theme').addEventListener('click', ()=>{
  document.body.classList.toggle('dark');
  if(document.body.classList.contains('dark')) { if(map.hasLayer(tileEsri)) map.removeLayer(tileEsri); tileDark.addTo(map); }
  else { if(map.hasLayer(tileDark)) map.removeLayer(tileDark); tileEsri.addTo(map); }
});

/* ================= Home page slider ================= */
let homeSlideIndex = 0;
let slideInterval;

function showSlide(n) {
  const slides = document.querySelectorAll('.home-slider-container .slide');
  if (n >= slides.length) { homeSlideIndex = 0; }
  if (n < 0) { homeSlideIndex = slides.length - 1; }
  slides.forEach(slide => slide.classList.remove('active'));
  if (slides[homeSlideIndex]) {
    slides[homeSlideIndex].classList.add('active');
  }
}

function moveSlide(n) {
  showSlide(homeSlideIndex += n);
  resetInterval();
}

function autoSlide() {
  homeSlideIndex++;
  showSlide(homeSlideIndex);
}

function resetInterval() {
  clearInterval(slideInterval);
  slideInterval = setInterval(autoSlide, 5000); // 5 seconds
}

function initializeSlider() {
  const homeSection = document.getElementById('home');
  if (homeSection.style.display !== 'none') {
    showSlide(homeSlideIndex);
    resetInterval();
  } else {
    clearInterval(slideInterval);
  }
}

/* ================= Feature Tab Navigation Logic ================= */
document.querySelectorAll('.feature-nav-btn').forEach(button => {
  button.addEventListener('click', () => {
    const targetId = button.dataset.target;
    
    document.querySelectorAll('.feature-nav-btn').forEach(btn => btn.classList.remove('active'));
    button.classList.add('active');
    
    document.querySelectorAll('.feature-content').forEach(content => {
      content.classList.remove('active');
      if (content.id === targetId) {
        content.classList.add('active');
      }
    });
  });
});

/* ================= WEATHER SECTION FUNCTIONALITY ================= */
function generateRandomWeatherData() {
  const condition = WEATHER_CONDITIONS[Math.floor(Math.random() * WEATHER_CONDITIONS.length)];
  const temp = Math.floor(Math.random() * 15) + 25; // 25-40¬∞C
  const humidity = Math.floor(Math.random() * 40) + 50; // 50-90%
  const windSpeed = Math.floor(Math.random() * 30) + 5; // 5-35 km/h
  const waveHeight = (Math.random() * 3 + 0.5).toFixed(1); // 0.5-3.5 m
  const visibility = Math.floor(Math.random() * 10) + 5; // 5-15 km
  const waterTemp = Math.floor(Math.random() * 8) + 26; // 26-34¬∞C
  
  return {
    condition,
    temp,
    humidity,
    windSpeed,
    waveHeight,
    visibility,
    waterTemp,
    windDirection: ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'][Math.floor(Math.random() * 8)],
    tide: Math.random() > 0.5 ? 'High' : 'Low',
    moonPhase: ['New', 'Waxing', 'Full', 'Waning'][Math.floor(Math.random() * 4)]
  };
}

function updateWeatherDisplay(location = 'Jakarta, Indonesia') {
  const weatherData = generateRandomWeatherData();
  
  // Update current weather
  document.getElementById('weather-location-name').textContent = location;
  document.getElementById('weather-current-icon').textContent = weatherData.condition.icon;
  document.getElementById('weather-current-temp').textContent = `${weatherData.temp}¬∞C`;
  document.getElementById('weather-current-desc').textContent = weatherData.condition.desc;
  document.getElementById('weather-humidity').textContent = `${weatherData.humidity}%`;
  document.getElementById('weather-wind').textContent = `${weatherData.windSpeed} km/h`;
  document.getElementById('weather-wave').textContent = `${weatherData.waveHeight} m`;
  document.getElementById('weather-visibility').textContent = `${weatherData.visibility} km`;
  
  // Update marine conditions
  document.getElementById('marine-wave-height').textContent = `${weatherData.waveHeight} m`;
  document.getElementById('marine-water-temp').textContent = `${weatherData.waterTemp}¬∞C`;
  document.getElementById('marine-wind-speed').textContent = `${weatherData.windSpeed} km/h`;
  document.getElementById('marine-wind-dir').textContent = weatherData.windDirection;
  document.getElementById('marine-tide').textContent = weatherData.tide;
  document.getElementById('marine-moon').textContent = weatherData.moonPhase;
  
  // Generate 5-day forecast
  generateForecast();
  
  // Update weather chart
  updateWeatherChart();
  
  // Check for weather alerts
  checkWeatherAlerts(weatherData);
}

function generateForecast() {
  const forecastContainer = document.getElementById('forecast-days');
  const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'];
  const today = new Date();
  const dayOfWeek = today.getDay();
  
  forecastContainer.innerHTML = '';
  
  for (let i = 0; i < 5; i++) {
    const dayIndex = (dayOfWeek + i) % 7;
    const dayName = i === 0 ? 'Today' : days[dayIndex === 0 ? 6 : dayIndex - 1];
    const weatherData = generateRandomWeatherData();
    
    const forecastDay = document.createElement('div');
    forecastDay.className = 'forecast-day';
    forecastDay.innerHTML = `
      <div class="forecast-day-name">${dayName}</div>
      <div class="forecast-day-icon">${weatherData.condition.icon}</div>
      <div class="forecast-day-temp">${weatherData.temp}¬∞C</div>
    `;
    
    forecastContainer.appendChild(forecastDay);
  }
}

function updateWeatherChart() {
  const ctx = document.getElementById('weather-chart').getContext('2d');
  
  // Generate hourly data for the chart
  const hours = [];
  const temps = [];
  const windSpeeds = [];
  const waveHeights = [];
  
  for (let i = 0; i < 24; i++) {
    hours.push(`${i}:00`);
    temps.push(Math.floor(Math.random() * 10) + 25);
    windSpeeds.push(Math.floor(Math.random() * 20) + 5);
    waveHeights.push((Math.random() * 2 + 0.5).toFixed(1));
  }
  
  if (weatherChart) {
    weatherChart.destroy();
  }
  
  weatherChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: hours,
      datasets: [
        {
          label: 'Temperature (¬∞C)',
          data: temps,
          borderColor: 'rgb(255, 99, 132)',
          backgroundColor: 'rgba(255, 99, 132, 0.2)',
          tension: 0.4,
          yAxisID: 'y'
        },
        {
          label: 'Wind Speed (km/h)',
          data: windSpeeds,
          borderColor: 'rgb(54, 162, 235)',
          backgroundColor: 'rgba(54, 162, 235, 0.2)',
          tension: 0.4,
          yAxisID: 'y1'
        },
        {
          label: 'Wave Height (m)',
          data: waveHeights,
          borderColor: 'rgb(75, 192, 192)',
          backgroundColor: 'rgba(75, 192, 192, 0.2)',
          tension: 0.4,
          yAxisID: 'y1'
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      interaction: {
        mode: 'index',
        intersect: false,
      },
      scales: {
        y: {
          type: 'linear',
          display: true,
          position: 'left',
          title: {
            display: true,
            text: 'Temperature (¬∞C)'
          }
        },
        y1: {
          type: 'linear',
          display: true,
          position: 'right',
          title: {
            display: true,
            text: 'Wind Speed (km/h) / Wave Height (m)'
          },
          grid: {
            drawOnChartArea: false,
          }
        }
      },
      plugins: {
        title: {
          display: true,
          text: '24-Hour Weather Forecast'
        },
        legend: {
          position: 'top',
        }
      }
    }
  });
}

function checkWeatherAlerts(weatherData) {
  const alertContainer = document.getElementById('weather-alert-container');
  alertContainer.innerHTML = '';
  
  // Check for dangerous conditions
  if (weatherData.waveHeight > 2.5 || weatherData.windSpeed > 25) {
    const alert = document.createElement('div');
    alert.className = 'weather-alert danger';
    alert.innerHTML = `
      <div class="weather-alert-icon">‚ö†Ô∏è</div>
      <div class="weather-alert-text">
        <div class="weather-alert-title">Dangerous Marine Conditions</div>
        <div>High waves and strong winds detected. Avoid going out to sea.</div>
      </div>
    `;
    alertContainer.appendChild(alert);
  } else if (weatherData.waveHeight > 1.5 || weatherData.windSpeed > 15) {
    const alert = document.createElement('div');
    alert.className = 'weather-alert';
    alert.innerHTML = `
      <div class="weather-alert-icon">‚ö†Ô∏è</div>
      <div class="weather-alert-text">
        <div class="weather-alert-title">Caution Advised</div>
        <div>Moderate waves and winds. Exercise caution when sailing.</div>
      </div>
    `;
    alertContainer.appendChild(alert);
  }
}

// Weather location search
document.getElementById('weather-location-input').addEventListener('keypress', (e) => {
  if (e.key === 'Enter') {
    const location = e.target.value.trim();
    if (location) {
      updateWeatherDisplay(location);
    }
  }
});

// Auto-refresh weather data every 5 minutes
setInterval(() => {
  const currentLocation = document.getElementById('weather-location-name').textContent;
  updateWeatherDisplay(currentLocation);
}, 300000); // 5 minutes

/* ================= Clustering & layers ================= */
const zoneCluster = L.markerClusterGroup({ chunkedLoading:true, maxClusterRadius:60 });
map.addLayer(zoneCluster);
const reportLayer = L.layerGroup().addTo(map);
let geojsonLayer = null;
let favoriteFeatures = [];

/* ================= Zone generation & Filtering (UPDATED LOGIC) ================= */
const zoneDefs = [
  { key:'green', color:'green', label:'Safe (Green)' },
  { key:'yellow', color:'goldenrod', label:'Caution (Yellow)' },
  { key:'red', color:'red', label:'Restricted (Red)' }
];

// --- NEW: Define coastal regions to concentrate zone spawning ---
const coastalRegions = [
  { name: 'Indonesia & SEA', latMin: -11, latMax: 10, lngMin: 95, lngMax: 141 },
  { name: 'Caribbean Sea', latMin: 9, latMax: 28, lngMin: -89, lngMax: -60 },
  { name: 'Mediterranean Sea', latMin: 30, latMax: 46, lngMin: -6, lngMax: 36 },
  { name: 'North Sea & Scandinavia', latMin: 50, latMax: 65, lngMin: -4, lngMax: 20 },
  { name: 'Sea of Japan', latMin: 33, latMax: 51, lngMin: 127, lngMax: 142 },
  { name: 'Gulf of Mexico', latMin: 18, latMax: 31, lngMin: -98, lngMax: -81 },
  { name: 'Bay of Bengal', latMin: 5, latMax: 22, lngMin: 80, lngMax: 95 },
  { name: 'Coral Triangle (East)', latMin: -10, latMax: 10, lngMin: 125, lngMax: 150 },
];

// --- NEW: Define major ports and their coordinates ---
const majorPorts = [
  { name: 'Tanjung Priok, Jakarta', lat: -6.1135, lng: 106.8776 },
  { name: 'Tanjung Perak, Surabaya', lat: -7.2139, lng: 112.7340 },
  { name: 'Belawan, Medan', lat: 3.7894, lng: 98.6904 },
  { name: 'Makassar', lat: -5.1477, lng: 119.4327 },
  { name: 'Bitung, Sulawesi', lat: 1.4453, lng: 125.1829 },
  { name: 'Singapore', lat: 1.2649, lng: 103.8220 },
  { name: 'Port Klang, Malaysia', lat: 3.0011, lng: 101.3933 },
  { name: 'Bangkok, Thailand', lat: 13.5996, lng: 100.5970 },
  { name: 'Manila, Philippines', lat: 14.5832, lng: 120.9668 },
  { name: 'Hong Kong', lat: 22.3027, lng: 114.1772 },
  { name: 'Shanghai, China', lat: 31.2304, lng: 121.4737 },
  { name: 'Tokyo, Japan', lat: 35.6762, lng: 139.6503 },
  { name: 'Busan, South Korea', lat: 35.1796, lng: 129.0756 },
  { name: 'Vladivostok, Russia', lat: 43.1332, lng: 131.9113 },
  { name: 'Los Angeles, USA', lat: 34.0522, lng: -118.2437 },
  { name: 'San Francisco, USA', lat: 37.7749, lng: -122.4194 },
  { name: 'New York, USA', lat: 40.7128, lng: -74.0060 },
  { name: 'Miami, USA', lat: 25.7617, lng: -80.1918 },
  { name: 'Rotterdam, Netherlands', lat: 51.9244, lng: 4.4777 },
  { name: 'Hamburg, Germany', lat: 53.5511, lng: 9.9937 },
  { name: 'Antwerp, Belgium', lat: 51.2194, lng: 4.4025 },
  { name: 'London, UK', lat: 51.5074, lng: -0.1278 },
  { name: 'Marseille, France', lat: 43.2965, lng: 5.3698 },
  { name: 'Barcelona, Spain', lat: 41.3851, lng: 2.1734 },
  { name: 'Istanbul, Turkey', lat: 41.0082, lng: 28.9784 },
  { name: 'Alexandria, Egypt', lat: 31.2001, lng: 29.9187 },
  { name: 'Dubai, UAE', lat: 25.2048, lng: 55.2708 },
  { name: 'Mumbai, India', lat: 19.0760, lng: 72.8777 },
  { name: 'Chennai, India', lat: 13.0827, lng: 80.2707 },
  { name: 'Colombo, Sri Lanka', lat: 6.9271, lng: 79.8612 },
  { name: 'Karachi, Pakistan', lat: 24.8607, lng: 67.0011 },
  { name: 'Durban, South Africa', lat: -29.8587, lng: 31.0218 },
  { name: 'Cape Town, South Africa', lat: -33.9249, lng: 18.4241 },
  { name: 'Sydney, Australia', lat: -33.8688, lng: 151.2093 },
  { name: 'Melbourne, Australia', lat: -37.8136, lng: 144.9631 },
  { name: 'Auckland, New Zealand', lat: -36.8485, lng: 174.7633 },
  { name: 'Valparaiso, Chile', lat: -33.0458, lng: -71.6197 },
  { name: 'Buenos Aires, Argentina', lat: -34.6037, lng: -58.3816 },
  { name: 'Rio de Janeiro, Brazil', lat: -22.9068, lng: -43.1729 },
  { name: 'Santos, Brazil', lat: -23.9608, lng: -46.3336 },
  { name: 'Lagos, Nigeria', lat: 6.5244, lng: 3.3792 },
  { name: 'Abidjan, Ivory Coast', lat: 5.3600, lng: -4.0083 },
  { name: 'Casablanca, Morocco', lat: 33.5731, lng: -7.5898 },
  { name: 'Dakar, Senegal', lat: 14.7167, lng: -17.4677 }
];

// --- NEW: Define major lakes and their coordinates ---
const majorLakes = [
  { name: 'Lake Toba, Indonesia', lat: 2.6096, lng: 98.9260 },
  { name: 'Lake Poso, Indonesia', lat: -1.9167, lng: 120.5833 },
  { name: 'Lake Matano, Indonesia', lat: -2.4833, lng: 121.3333 },
  { name: 'Lake Towuti, Indonesia', lat: -2.7500, lng: 121.5000 },
  { name: 'Lake Sentani, Indonesia', lat: -2.6167, lng: 140.5667 },
  { name: 'Lake Baikal, Russia', lat: 53.5000, lng: 108.0000 },
  { name: 'Great Bear Lake, Canada', lat: 66.0000, lng: -121.0000 },
  { name: 'Great Slave Lake, Canada', lat: 61.5000, lng: -114.0000 },
  { name: 'Lake Superior, USA/Canada', lat: 47.5000, lng: -87.5000 },
  { name: 'Lake Michigan, USA', lat: 44.0000, lng: -87.0000 },
  { name: 'Lake Huron, USA/Canada', lat: 44.8000, lng: -82.4000 },
  { name: 'Lake Erie, USA/Canada', lat: 42.2000, lng: -81.2000 },
  { name: 'Lake Ontario, USA/Canada', lat: 43.7000, lng: -77.9000 },
  { name: 'Lake Victoria, Africa', lat: -1.0000, lng: 33.0000 },
  { name: 'Lake Tanganyika, Africa', lat: -6.0000, lng: 29.5000 },
  { name: 'Lake Malawi, Africa', lat: -12.0000, lng: 34.5000 },
  { name: 'Lake Chad, Africa', lat: 13.0000, lng: 14.0000 },
  { name: 'Caspian Sea', lat: 41.0000, lng: 51.0000 },
  { name: 'Aral Sea', lat: 45.0000, lng: 60.0000 },
  { name: 'Lake Balkhash, Kazakhstan', lat: 46.5000, lng: 75.0000 },
  { name: 'Lake Issyk-Kul, Kyrgyzstan', lat: 42.4167, lng: 77.2500 },
  { name: 'Lake Van, Turkey', lat: 38.6333, lng: 42.8167 },
  { name: 'Lake Titicaca, Peru/Bolivia', lat: -15.8333, lng: -69.3333 },
  { name: 'Lake Maracaibo, Venezuela', lat: 9.8000, lng: -71.5667 },
  { name: 'Lake Nicaragua, Nicaragua', lat: 11.6167, lng: -85.3500 },
  { name: 'Lake Athabasca, Canada', lat: 59.2500, lng: -108.5000 },
  { name: 'Reindeer Lake, Canada', lat: 57.2500, lng: -102.5000 },
  { name: 'Lake Winnipeg, Canada', lat: 52.1167, lng: -97.2500 },
  { name: 'Lake of the Woods, USA/Canada', lat: 49.0833, lng: -94.8333 },
  { name: 'Great Salt Lake, USA', lat: 41.1667, lng: -112.5833 },
  { name: 'Lake Okeechobee, USA', lat: 26.9333, lng: -80.8000 },
  { name: 'Lake Tahoe, USA', lat: 39.0833, lng: -120.0333 },
  { name: 'Crater Lake, USA', lat: 42.9333, lng: -122.1167 },
  { name: 'Lake Ladoga, Russia', lat: 61.0000, lng: 31.5000 },
  { name: 'Lake Onega, Russia', lat: 61.7000, lng: 35.6000 },
  { name: 'Lake V√§nern, Sweden', lat: 58.9167, lng: 13.5000 },
  { name: 'Lake V√§ttern, Sweden', lat: 58.4167, lng: 14.5000 },
  { name: 'Lake Geneva, Switzerland/France', lat: 46.4333, lng: 6.4333 },
  { name: 'Lake Constance, Germany/Switzerland/Austria', lat: 47.5833, lng: 9.4167 },
  { name: 'Lake Garda, Italy', lat: 45.6333, lng: 10.6667 },
  { name: 'Lake Maggiore, Italy/Switzerland', lat: 45.9667, lng: 8.6500 },
  { name: 'Lake Como, Italy', lat: 46.0000, lng: 9.2667 },
  { name: 'Loch Ness, Scotland', lat: 57.3000, lng: -4.4500 },
  { name: 'Lake District, England', lat: 54.5000, lng: -3.1667 },
  { name: 'Lake Biwa, Japan', lat: 35.2500, lng: 136.0833 },
  { name: 'Lake Inle, Myanmar', lat: 20.5500, lng: 96.9167 },
  { name: 'Tonl√© Sap, Cambodia', lat: 12.8833, lng: 104.0667 },
  { name: 'Lake Taupo, New Zealand', lat: -38.7833, lng: 175.9000 },
  { name: 'Lake Eyre, Australia', lat: -28.5000, lng: 137.3333 },
  { name: 'Lake Torrens, Australia', lat: -31.0333, lng: 137.8667 },
  { name: 'Lake Gairdner, Australia', lat: -31.5667, lng: 136.0000 }
];

function generateCoastalPoint() {
  // Pick a random region
  const region = coastalRegions[Math.floor(Math.random() * coastalRegions.length)];

  // Generate a random lat/lng within that region's bounds
  const lat = region.latMin + Math.random() * (region.latMax - region.latMin);
  const lng = region.lngMin + Math.random() * (region.lngMax - region.lngMin);

  return { lat, lng };
}

function generatePortPoint() {
  // Pick a random port
  const port = majorPorts[Math.floor(Math.random() * majorPorts.length)];
  
  // Generate a point within 50km of the port
  const radius = 0.45; // Approximately 50km in degrees
  const lat = port.lat + (Math.random() * 2 - 1) * radius;
  const lng = port.lng + (Math.random() * 2 - 1) * radius;
  
  return { lat, lng };
}

function generateLakePoint() {
  // Pick a random lake
  const lake = majorLakes[Math.floor(Math.random() * majorLakes.length)];
  
  // Generate a point within the lake area
  const radius = 0.3; // Approximately 30km in degrees
  const lat = lake.lat + (Math.random() * 2 - 1) * radius;
  const lng = lake.lng + (Math.random() * 2 - 1) * radius;
  
  return { lat, lng };
}

/* ================= Fish Movement System ================= */
function createMovingFishMarker(lat, lng, fishType, zoneStatus) {
  // Create a special marker for moving fish that uses the zone color
  const zoneColor = zoneStatus === 'green' ? 'green' : zoneStatus === 'yellow' ? 'goldenrod' : 'red';
  const fishIcon = L.divIcon({
    className: 'moving-fish-marker',
    html: `<div style="background:${zoneColor}; width:12px; height:12px; border-radius:50%; border:2px solid white; box-shadow:0 0 5px rgba(0,0,0,0.7); animation:pulse 2s infinite;"></div>`,
    iconSize: [16, 16],
    iconAnchor: [8, 8]
  });
  
  const marker = L.marker([lat, lng], { 
    icon: fishIcon,
    zIndexOffset: 1000 // Ensure fish markers appear above other markers
  });
  
  // Store movement properties
  marker.fishData = {
    type: fishType,
    zoneStatus: zoneStatus,
    direction: Math.random() * 2 * Math.PI, // Random initial direction in radians
    speed: 0.001 + Math.random() * 0.002, // Base movement speed
    lastMoveTime: Date.now(),
    movementPattern: Math.floor(Math.random() * 3) // 0: linear, 1: circular, 2: wandering
  };
  
  // Add popup with fish information
  const fishInfo = FISH_DATA.find(f => f.name === fishType) || { name: fishType, desc: 'Ikan bergerak', habitat: 'Laut' };
  const zoneDescription = zoneStatus === 'green' ? 'Aman untuk ditangkap' : 
                         zoneStatus === 'yellow' ? 'Hati-hati - Perkembangbiakan' : 
                         'Terlarang - Populasi Kritis';
  
  marker.bindPopup(`
    <div style="line-height: 1.5;">
      <strong>${fishInfo.name}</strong><br>
      <em>Zona: ${zoneStatus.toUpperCase()} - ${zoneDescription}</em><br>
      <hr style="margin: 4px 0;">
      <strong>Habitat:</strong> ${fishInfo.habitat}<br>
      <strong>Status:</strong> <span style="color:${zoneColor}">${zoneDescription}</span><br>
      <small>Koordinat: ${lat.toFixed(4)}, ${lng.toFixed(4)}</small>
    </div>
  `);
  
  return marker;
}

function moveFish() {
  if (!fishMovementActive) return;
  
  const now = Date.now();
  const timeDelta = Math.min((now - (movingFishMarkers[0]?.fishData?.lastMoveTime || now)) / 1000, 0.1);
  
  movingFishMarkers.forEach(marker => {
    if (!marker.fishData) return;
    
    const latlng = marker.getLatLng();
    const data = marker.fishData;
    
    // Update direction based on movement pattern
    switch(data.movementPattern) {
      case 0: // Linear movement
        // Occasionally change direction
        if (Math.random() < 0.02) {
          data.direction = Math.random() * 2 * Math.PI;
        }
        break;
      case 1: // Circular movement
        data.direction += 0.1;
        break;
      case 2: // Wandering movement
        data.direction += (Math.random() - 0.5) * 0.5;
        break;
    }
    
    // Calculate new position based on direction and speed
    const speedMultiplier = fishSpeed / 3; // Adjust speed based on slider
    const distance = data.speed * speedMultiplier * timeDelta * 60;
    
    const newLat = latlng.lat + Math.sin(data.direction) * distance;
    const newLng = latlng.lng + Math.cos(data.direction) * distance;
    
    // Boundary checking - keep fish in reasonable areas
    const boundedLat = Math.max(-85, Math.min(85, newLat));
    const boundedLng = ((newLng + 180) % 360 + 360) % 360 - 180;
    
    // Update marker position
    marker.setLatLng([boundedLat, boundedLng]);
    
    // Update last move time
    data.lastMoveTime = now;
  });
}

function toggleFishMovement() {
  fishMovementActive = !fishMovementActive;
  
  const toggleBtn = document.getElementById('btn-toggle-fish-movement');
  const statusEl = document.getElementById('fish-movement-status');
  
  if (fishMovementActive) {
    toggleBtn.textContent = 'Stop Fish Movement';
    statusEl.textContent = 'Running';
    statusEl.style.color = 'green';
    
    // Start movement interval
    if (!fishMovementInterval) {
      fishMovementInterval = setInterval(moveFish, 100); // Update every 100ms for smooth movement
    }
  } else {
    toggleBtn.textContent = 'Start Fish Movement';
    statusEl.textContent = 'Stopped';
    statusEl.style.color = 'red';
    
    // Clear movement interval
    if (fishMovementInterval) {
      clearInterval(fishMovementInterval);
      fishMovementInterval = null;
    }
  }
}

function resetFishPositions() {
  // Remove all existing moving fish
  movingFishMarkers.forEach(marker => {
    map.removeLayer(marker);
  });
  movingFishMarkers = [];
  
  // Generate new moving fish
  generateMovingFish(50); // Generate 50 moving fish
}

function generateMovingFish(count = 50) {
  // Clear existing moving fish
  movingFishMarkers.forEach(marker => {
    map.removeLayer(marker);
  });
  movingFishMarkers = [];
  
  // Get fish types from FISH_DATA
  const fishTypes = FISH_DATA.map(f => f.name);
  
  for (let i = 0; i < count; i++) {
    // Randomly choose between coastal, port, or lake location
    const locationType = Math.floor(Math.random() * 3);
    let point;
    
    if (locationType === 0) {
      point = generateCoastalPoint();
    } else if (locationType === 1) {
      point = generatePortPoint();
    } else {
      point = generateLakePoint();
    }
    
    const randomFishType = fishTypes[Math.floor(Math.random() * fishTypes.length)];
    const zoneStatus = zoneDefs[Math.floor(Math.random() * zoneDefs.length)].key;
    const fishMarker = createMovingFishMarker(point.lat, point.lng, randomFishType, zoneStatus);
    
    // Add to map and tracking array
    fishMarker.addTo(map);
    movingFishMarkers.push(fishMarker);
  }
}

function createZoneMarker(lat,lng,status){
  const color = (status==='green') ? 'green' : (status==='yellow') ? 'goldenrod' : 'red';
  const marker = L.circleMarker([lat,lng], { radius:6, fillColor:color, color:color, weight:1, fillOpacity:0.85 });
  marker.feature = { type:'Feature', properties:{ status }, geometry:{ type:'Point', coordinates:[lng,lat] } };
  
  marker.on('click', (e) => {
    const clickedMarker = e.target;
    const latlng = clickedMarker.getLatLng();
    const currentStatus = clickedMarker.feature.properties.status;
    const marine = simulateMarine(latlng.lat, latlng.lng);
    
    const zoneDescription = currentStatus === 'green' ? 'Aman untuk ditangkap' : 
                           currentStatus === 'yellow' ? 'Hati-hati - Perkembangbiakan' : 
                           'Terlarang - Populasi Kritis';
    
    const popupContent = `
      <div style="line-height: 1.5;">
        <strong>Zona: ${currentStatus.charAt(0).toUpperCase() + currentStatus.slice(1)}</strong><br>
        <em>${zoneDescription}</em><br>
        <strong>Koordinat:</strong> ${latlng.lat.toFixed(4)}, ${latlng.lng.toFixed(4)}<br>
        <hr style="margin: 4px 0;">
        <strong>Cuaca (Simulasi):</strong><br>
        üåä Gelombang: ${marine.wave} m<br>
        üí® Angin: ${marine.wind} m/s<br>
        üå°Ô∏è Suhu Laut: ${marine.sst} ¬∞C
      </div>
    `;
    clickedMarker.bindPopup(popupContent).openPopup();
    rightPanel.classList.remove('closed');
    togglePanelBtn.textContent = t('map_panel_close');
    showForecastFor(latlng.lat, latlng.lng);
  });

  return marker;
}

function generateZones(count=700){
  allZoneMarkers = []; 
  zoneCluster.clearLayers();
  
  // Calculate distribution
  const coastalCount = Math.floor(count * 0.6); // 60% coastal areas
  const portCount = Math.floor(count * 0.25);   // 25% near ports
  const lakeCount = count - coastalCount - portCount; // 15% lakes
  
  // Generate coastal zones
  for(let i=0; i<coastalCount; i++){
    const { lat, lng } = generateCoastalPoint();
    const statusPick = zoneDefs[Math.floor(Math.random()*zoneDefs.length)].key;
    const m = createZoneMarker(lat,lng,statusPick);
    allZoneMarkers.push(m);
  }
  
  // Generate port zones
  for(let i=0; i<portCount; i++){
    const { lat, lng } = generatePortPoint();
    const statusPick = zoneDefs[Math.floor(Math.random()*zoneDefs.length)].key;
    const m = createZoneMarker(lat,lng,statusPick);
    allZoneMarkers.push(m);
  }
  
  // Generate lake zones
  for(let i=0; i<lakeCount; i++){
    const { lat, lng } = generateLakePoint();
    const statusPick = zoneDefs[Math.floor(Math.random()*zoneDefs.length)].key;
    const m = createZoneMarker(lat,lng,statusPick);
    allZoneMarkers.push(m);
  }
  
  applyFilters(); 
  
  // Generate moving fish - now using the same zones
  generateMovingFish(50);
}

document.getElementById('show-green').addEventListener('change', applyFilters);
document.getElementById('show-yellow').addEventListener('change', applyFilters);
document.getElementById('show-red').addEventListener('change', applyFilters);

function applyFilters(){
  zoneCluster.clearLayers();
  const showGreen = document.getElementById('show-green').checked;
  const showYellow = document.getElementById('show-yellow').checked;
  const showRed = document.getElementById('show-red').checked;

  const filteredMarkers = allZoneMarkers.filter(l => {
    const s = l.feature?.properties?.status || 'green';
    return (s==='green' && showGreen) || (s==='yellow' && showYellow) || (s==='red' && showRed);
  });

  zoneCluster.addLayers(filteredMarkers);
}

/* ================= Fish Movement Controls ================= */
document.getElementById('btn-toggle-fish-movement').addEventListener('click', toggleFishMovement);
document.getElementById('btn-reset-fish-positions').addEventListener('click', resetFishPositions);

// Fish speed slider
const fishSpeedSlider = document.getElementById('fish-speed-slider');
const fishSpeedValue = document.getElementById('fish-speed-value');

fishSpeedSlider.addEventListener('input', function() {
  fishSpeed = parseInt(this.value);
  fishSpeedValue.textContent = fishSpeed + 'x';
});

/* ================= Toggle All UI Features ================= */
document.getElementById('btn-toggle-all').addEventListener('click', () => {
    document.querySelectorAll('.map-ui-element').forEach(el => {
        el.classList.toggle('hidden');
    });
});

/* ================= Random status updates ================= */
function toggleRandomization() {
  randomizeOn = !randomizeOn;
  applyI18n(); 
}
document.getElementById('toggle-random').addEventListener('click', toggleRandomization);
document.getElementById('btn-random-toggle').addEventListener('click', toggleRandomization);

function randomizeZones(){
  allZoneMarkers.forEach(layer=>{
    const r = Math.random();
    const status = (r<0.33) ? 'green' : (r<0.66) ? 'yellow' : 'red';
    const color = status==='green'?'green':status==='yellow'?'goldenrod':'red';
    layer.setStyle({ fillColor: color, color: color });
    if(layer.feature?.properties) layer.feature.properties.status = status;
  });
  applyFilters(); 
}
setInterval(()=>{ if(randomizeOn) randomizeZones(); }, 60000);

/* ================= GeoJSON load & favorite toggling ================= */
document.getElementById('btn-load').addEventListener('click', ()=>{
  const u = prompt('Enter public GeoJSON URL or type "file" to upload from your device:');
  if(!u) return;
  if(u.toLowerCase() === 'file'){
    const inp = document.createElement('input'); inp.type='file'; inp.accept='.json,.geojson';
    inp.onchange = (e)=> {
      const f = e.target.files[0]; if(!f) return;
      const r = new FileReader();
      r.onload = ()=> {
        try{ const geo = JSON.parse(r.result); addGeoJSONLayer(geo); alert(t('alert_geojson_local_loaded')); } catch(err){ alert(t('alert_invalid_file')); }
      }; r.readAsText(f);
    };
    inp.click();
  } else {
    fetch(u).then(r=>r.json()).then(geo => { addGeoJSONLayer(geo); alert(t('alert_geojson_url_loaded')); }).catch(()=> alert(t('alert_geojson_failed')));
  }
});

function addGeoJSONLayer(geo){
  if(geojsonLayer) map.removeLayer(geojsonLayer);
  geojsonLayer = L.geoJSON(geo, {
    style: f => {
      const st = f.properties?.status || 'green';
      const color = st==='green' ? 'green' : st==='yellow' ? 'goldenrod' : 'red';
      return { color, weight:1.6, fillOpacity:0.18 };
    },
    onEachFeature: (f,layer) => {
      layer.bindPopup(`<b>${f.properties?.name || 'Zone'}</b><br/>Status: ${f.properties?.status || 'green'}<br/><button class="fav-btn">Toggle Favorite</button>`);
      layer.on('popupopen', (e) => {
        const btn = e.popup.getElement().querySelector('.fav-btn');
        if(btn) btn.addEventListener('click', ()=> toggleFavoriteFeature(f, layer));
      });
    }
  }).addTo(map);
  try{ map.fitBounds(geojsonLayer.getBounds()); } catch(e){}
}

function toggleFavoriteFeature(feature, layer){
  const idx = favoriteFeatures.findIndex(f => f === feature);
  if(idx === -1){ favoriteFeatures.push(feature); layer.setStyle({fillOpacity:0.6}); alert(t('alert_added_favorites')); }
  else { favoriteFeatures.splice(idx,1); layer.setStyle({fillOpacity:0.18}); alert(t('alert_removed_favorites')); }
}

document.getElementById('btn-export-fav').addEventListener('click', ()=>{
  if(!favoriteFeatures.length){ alert(t('alert_no_favorites')); return; }
  const fc = { type:'FeatureCollection', features: favoriteFeatures };
  const blob = new Blob([JSON.stringify(fc,null,2)], { type:'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='favorite_zones.geojson'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
});

/* ================= Simulated Marine Weather & Safety (REAL-TIME UPDATE) ================= */
function pseudoNoise(lat,lng,seed=0){
  const x = Math.abs(Math.sin(lat*12.345 + lng*7.89 + seed*3.14))*10000;
  return (x - Math.floor(x)) * 2 - 1;
}

function simulateMarine(lat,lng){
  const baseWave = Math.max(0, Math.abs(pseudoNoise(lat,lng,1))*3.5);
  const baseWind = Math.max(0, Math.abs(pseudoNoise(lat,lng,2))*12);
  const sst = 5 + Math.abs(pseudoNoise(lat,lng,3))*25;
  
  const now = new Date();
  const secondsInDay = now.getUTCHours() * 3600 + now.getUTCMinutes() * 60 + now.getUTCSeconds();
  const diurnal = Math.abs(Math.sin(secondsInDay / 86400 * Math.PI * 2)) * 0.6; 
  
  const wave = +(baseWave + diurnal).toFixed(2);
  const wind = +(baseWind + diurnal*2).toFixed(1);
  const temp = +sst.toFixed(1);
  return { wave, wind, sst: temp, summary: `${wave} m waves, ${wind} m/s wind, SST ${temp}¬∞C` };
}

function safetyAdvice(marine){
  if(marine.wave >= 4.0 || marine.wind >= 15) return { level:'danger', text:'DANGER ‚Äî Not safe to go out.' };
  if(marine.wave >= 2.5 || marine.wind >= 10) return { level:'warning', text:'CAUTION ‚Äî Rough seas, consider postponing.' };
  return { level:'safe', text:'SAFE ‚Äî Conditions relatively calm.' };
}

const forecastInfo = document.getElementById('forecast-info');
const forecastDetails = document.getElementById('forecast-details');
const rightPanel = document.getElementById('rightPanel');
const togglePanelBtn = document.getElementById('toggle-panel');
togglePanelBtn.addEventListener('click', ()=> {
  const isClosed = rightPanel.classList.toggle('closed');
  togglePanelBtn.textContent = isClosed ? t('map_panel_open') : t('map_panel_close');
});

let lastClickedPoint = null;
let autoUpdateForecast = true;
document.getElementById('auto-update-forecast').addEventListener('change', (e)=> { autoUpdateForecast = e.target.checked; });

function showForecastFor(lat, lng){
  lastClickedPoint = { lat, lng };
  const marine = simulateMarine(lat,lng);
  const advice = safetyAdvice(marine);
  forecastInfo.innerHTML = `<strong>Forecast</strong>: ${marine.summary}`;
  forecastDetails.innerHTML = `<div><strong>Wave</strong>: ${marine.wave} m<br/><strong>Wind</strong>: ${marine.wind} m/s<br/><strong>SST</strong>: ${marine.sst} ¬∞C<br/><p style="margin:.5rem 0"><em>${advice.text}</em></p></div>`;
  forecastDetails.style.padding='8px';
  forecastDetails.style.borderRadius='6px';
  if(advice.level==='danger') forecastDetails.style.background = 'rgba(185,28,28,0.06)';
  else if(advice.level==='warning') forecastDetails.style.background = 'rgba(245,158,11,0.06)';
  else forecastDetails.style.background = 'rgba(5,150,105,0.04)';
}

document.getElementById('btn-refresh-forecast').addEventListener('click', ()=>{
  if(lastClickedPoint) showForecastFor(lastClickedPoint.lat, lastClickedPoint.lng);
});

setInterval(()=> {
  if(autoUpdateForecast && lastClickedPoint) showForecastFor(lastClickedPoint.lat, lastClickedPoint.lng);
}, 3000);

/* ================= Marine Forecast Panel Update ================= */
function updateMarineForecastPanel(lat, lng) {
  const marine = simulateMarine(lat, lng);
  const advice = safetyAdvice(marine);
  
  // Update the marine forecast panel
  document.getElementById('marine-forecast-wave').textContent = `${marine.wave} m`;
  document.getElementById('marine-forecast-wind').textContent = `${marine.wind} m/s`;
  document.getElementById('marine-forecast-temp').textContent = `${marine.sst}¬∞C`;
  
  // Set visibility based on wave height
  let visibility = 'Good';
  if (marine.wave > 2.5) visibility = 'Poor';
  else if (marine.wave > 1.5) visibility = 'Moderate';
  document.getElementById('marine-forecast-visibility').textContent = visibility;
  
  // Update safety status
  const safetyStatus = document.getElementById('marine-safety-status');
  safetyStatus.textContent = advice.level.toUpperCase() + ' - ' + advice.text.split(' ‚Äî ')[0];
  safetyStatus.className = 'marine-safety-status';
  
  if (advice.level === 'danger') {
    safetyStatus.classList.add('safety-danger');
  } else if (advice.level === 'warning') {
    safetyStatus.classList.add('safety-caution');
  } else {
    safetyStatus.classList.add('safety-safe');
  }
}

// Update marine forecast panel when map is clicked
map.on('click', (e) => {
  updateMarineForecastPanel(e.latlng.lat, e.latlng.lng);
});

// Initialize marine forecast panel with default values
updateMarineForecastPanel(-2, 118); // Default to Indonesia center

/* ================= User reports (click map to add) ================= */
let reportMode = false;
document.addEventListener('keydown', (ev)=> { if(ev.key.toLowerCase()==='r'){ reportMode=true; alert(t('alert_report_mode_on')); }});
map.on('click', (e)=> {
  if(reportMode) {
    reportMode = false;
    const species = prompt(t('prompt_species_caught'));
    if(!species) return alert(t('alert_canceled'));
    const weight = prompt(t('prompt_weight_optional'));
    const rec = { lat: e.latlng.lat, lng: e.latlng.lng, species, weight, time: new Date().toISOString() };
    saveReport(rec); addReport(rec); alert(t('alert_report_saved'));
  }
});

function addReport(rec){
  const marker = L.marker([rec.lat, rec.lng], { title: rec.species }).bindPopup(`<b>${rec.species}</b><br/>${rec.weight||'-'} kg<br/><small>${new Date(rec.time).toLocaleString()}</small>`);
  reportLayer.addLayer(marker);
}
function saveReport(rec){
  const arr = JSON.parse(localStorage.getItem('gisfishit_reports') || '[]');
  arr.push(rec); localStorage.setItem('gisfishit_reports', JSON.stringify(arr));
}
function loadReports(){
  const arr = JSON.parse(localStorage.getItem('gisfishit_reports') || '[]');
  arr.forEach(addReport);
}

document.getElementById('btn-clear-reports').addEventListener('click', ()=> {
  if(confirm(t('confirm_clear_reports'))){ localStorage.removeItem('gisfishit_reports'); reportLayer.clearLayers(); alert(t('alert_cleared')); }
});

/* ================= Search (Nominatim) ================= */
document.getElementById('btn-search').addEventListener('click', async ()=>{
  const q = document.getElementById('loc-input').value.trim();
  if(!q) return alert(t('alert_enter_search'));
  const coords = q.match(/^(-?\d+(?:\.\d+)?)[, ]+(-?\d+(?:\.\d+)?)/);
  if(coords){ map.setView([+coords[1], +coords[2]], 6); return; }
  try{
    const r = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(q)}&limit=1`);
    const j = await r.json();
    if(!j || !j[0]) return alert(t('alert_not_found'));
    const lat = +j[0].lat, lon = +j[0].lon;
    map.setView([lat,lon],6);
    L.marker([lat,lon]).addTo(map).bindPopup(`<b>${j[0].display_name}</b>`).openPopup();
  }catch(e){ console.error(e); alert(t('alert_search_failed')); }
});
document.getElementById('btn-home').addEventListener('click', ()=> map.setView([-2, 118], 5));

/* ================= Generate / Regenerate UI ================= */
document.getElementById('btn-gen').addEventListener('click', ()=> generateZones(700));
document.getElementById('btn-regen').addEventListener('click', ()=> generateZones(700));

/* ================= Feedback saving (phone) ================= */
function saveFeedbackLocal(){
  const phone = document.getElementById('fb-phone').value.trim();
  const msg = document.getElementById('fb-message').value.trim();
  if(!phone){ alert(t('alert_phone_required')); return; }
  const arr = JSON.parse(localStorage.getItem('gisfishit_feedback') || '[]');
  arr.push({ phone, msg, time: new Date().toISOString() });
  localStorage.setItem('gisfishit_feedback', JSON.stringify(arr));
  document.getElementById('fb-status').textContent = t('feedback_saved');
}
document.getElementById('save-local').addEventListener('click', saveFeedbackLocal);

/* ================= Export / Import data ================= */
document.getElementById('export-data').addEventListener('click', ()=>{
  const data = {
    reports: JSON.parse(localStorage.getItem('gisfishit_reports') || '[]'),
    feedback: JSON.parse(localStorage.getItem('gisfishit_feedback') || '[]'),
    favorites: favoriteFeatures
  };
  const blob = new Blob([JSON.stringify(data, null, 2)], { type:'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='gisfishit-data.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
});
document.getElementById('import-data').addEventListener('click', ()=>{
  const inp = document.createElement('input'); inp.type='file'; inp.accept='application/json';
  inp.onchange = (e) => {
    const f = e.target.files[0]; if(!f) return;
    const r = new FileReader(); r.onload = () => {
      try{
        const obj = JSON.parse(r.result);
        if(obj.reports){ localStorage.setItem('gisfishit_reports', JSON.stringify(obj.reports)); reportLayer.clearLayers(); loadReports(); }
        if(obj.feedback) localStorage.setItem('gisfishit_feedback', JSON.stringify(obj.feedback));
        alert(t('alert_imported_locally'));
      }catch(e){ alert(t('alert_invalid_file')); }
    }; r.readAsText(f);
  }; inp.click();
});

/* ================= Footer hide/show (UPDATED) ================= */
document.getElementById('hide-footer').addEventListener('click', ()=>{
  document.querySelector('footer').classList.add('hidden');
  document.getElementById('show-footer').style.display = 'block';
});
document.getElementById('show-footer').addEventListener('click', ()=>{
  document.querySelector('footer').classList.remove('hidden');
  document.getElementById('show-footer').style.display = 'none';
});

/* ================= Navigation handling (UPDATED) ================= */
document.querySelectorAll('.nav-btn').forEach(b => b.addEventListener('click', (e)=>{
  const targetId = b.getAttribute('data-target');
  document.querySelectorAll('main > section').forEach(s=>s.style.display='none');
  const targetSection = document.getElementById(targetId);
  if(targetSection) targetSection.style.display='block';
  
  document.querySelectorAll('.nav-btn').forEach(n=>n.classList.remove('active'));
  b.classList.add('active');
  
  if (targetId === 'mapSection') {
    setTimeout(()=> map.invalidateSize(), 200);
  }
  
  if (targetId === 'home') {
    initializeSlider();
  } else {
    clearInterval(slideInterval);
  }
  
  if (targetId === 'weatherSection') {
    updateWeatherDisplay();
  }
}));

/* ================= Initial App State (UPDATED) ================= */
function initializeApp() {
  populateFishTable(); // Populate the static fish tables ONCE
  applyI18n(); // Apply initial language translations
  loadReports();
  generateZones(700);
  initializeSlider();
  updateWeatherDisplay(); // Initialize weather display
  
  // Set footer to hidden by default
  document.querySelector('footer').classList.add('hidden');
  document.getElementById('show-footer').style.display = 'block';
  
  console.log('GISFishIt initialized with moving fish zones.');
}

initializeApp();

</script>
</body>
</html>


